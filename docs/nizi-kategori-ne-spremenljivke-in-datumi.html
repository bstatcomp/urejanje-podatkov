<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Poglavje 3 Nizi, kategorične spremenljivke in datumi | Urejanje podatkov</title>
  <meta name="description" content="Gradivo za delavnico Urejanje podatkov pobude DataScience@UL-FRI." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Poglavje 3 Nizi, kategorične spremenljivke in datumi | Urejanje podatkov" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Gradivo za delavnico Urejanje podatkov pobude DataScience@UL-FRI." />
  <meta name="github-repo" content="bstatcomp/urejanje-podatkov" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Poglavje 3 Nizi, kategorične spremenljivke in datumi | Urejanje podatkov" />
  
  <meta name="twitter:description" content="Gradivo za delavnico Urejanje podatkov pobude DataScience@UL-FRI." />
  

<meta name="author" content="Gregor Pirš, Matej Pičulin in Erik Štrumbelj" />


<meta name="date" content="2021-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="urejeni-in-relacijski-podatki.html"/>
<link rel="next" href="reference.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Urejanje podatkov</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Uvod</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#struktura-te-knjige"><i class="fa fa-check"></i>Struktura te knjige</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#stil-programske-kode"><i class="fa fa-check"></i>Stil programske kode</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html"><i class="fa fa-check"></i><b>1</b> Slovnica ravnanja s podatki</a>
<ul>
<li class="chapter" data-level="1.1" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#priprava"><i class="fa fa-check"></i><b>1.1</b> Priprava</a></li>
<li class="chapter" data-level="1.2" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#sodobna-razpredelnica-tibble"><i class="fa fa-check"></i><b>1.2</b> Sodobna razpredelnica: <code>tibble</code></a></li>
<li class="chapter" data-level="1.3" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#urejeno-ovrednotenje"><i class="fa fa-check"></i><b>1.3</b> Urejeno ovrednotenje</a></li>
<li class="chapter" data-level="1.4" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#izbira-vrstic-s-filter"><i class="fa fa-check"></i><b>1.4</b> Izbira vrstic s <code>filter()</code></a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#manjkajoče-vrednosti"><i class="fa fa-check"></i><b>1.4.1</b> Manjkajoče vrednosti</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#izbira-stolpcev-s-select"><i class="fa fa-check"></i><b>1.5</b> Izbira stolpcev s <code>select()</code></a></li>
<li class="chapter" data-level="1.6" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#urejanje-vrstic-z-arrange"><i class="fa fa-check"></i><b>1.6</b> Urejanje vrstic z <code>arrange()</code></a></li>
<li class="chapter" data-level="1.7" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#dodajanje-novih-spremenljivk-z-mutate"><i class="fa fa-check"></i><b>1.7</b> Dodajanje novih spremenljivk z <code>mutate()</code></a></li>
<li class="chapter" data-level="1.8" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#povzemanje-vrednosti-s-summarise"><i class="fa fa-check"></i><b>1.8</b> Povzemanje vrednosti s <code>summarise()</code></a></li>
<li class="chapter" data-level="1.9" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#pipe"><i class="fa fa-check"></i><b>1.9</b> Pipe</a></li>
<li class="chapter" data-level="1.10" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#filter-in-mutate-na-združenih-podatkih"><i class="fa fa-check"></i><b>1.10</b> <code>filter()</code> in <code>mutate()</code> na združenih podatkih</a></li>
<li class="chapter" data-level="1.11" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#izvajanje-operacij-nad-večimi-stolpci-z-across"><i class="fa fa-check"></i><b>1.11</b> Izvajanje operacij nad večimi stolpci z <code>across()</code></a></li>
<li class="chapter" data-level="1.12" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#povzemanje-stolpcev"><i class="fa fa-check"></i><b>1.12</b> Povzemanje stolpcev</a></li>
<li class="chapter" data-level="1.13" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#povzemanje-vrstic"><i class="fa fa-check"></i><b>1.13</b> Povzemanje vrstic</a></li>
<li class="chapter" data-level="1.14" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#dodatek"><i class="fa fa-check"></i><b>1.14</b> Dodatek</a>
<ul>
<li class="chapter" data-level="1.14.1" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#zamenjava-vrstnega-reda-stolpcev"><i class="fa fa-check"></i><b>1.14.1</b> Zamenjava vrstnega reda stolpcev</a></li>
<li class="chapter" data-level="1.14.2" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#preimenovanje-stolpcev"><i class="fa fa-check"></i><b>1.14.2</b> Preimenovanje stolpcev</a></li>
<li class="chapter" data-level="1.14.3" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#summarise-in-group-unpeeling"><i class="fa fa-check"></i><b>1.14.3</b> Summarise in group unpeeling</a></li>
</ul></li>
<li class="chapter" data-level="1.15" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#ali-želite-izvedeti-več"><i class="fa fa-check"></i><b>1.15</b> Ali želite izvedeti več?</a></li>
<li class="chapter" data-level="1.16" data-path="slovnica-ravnanja-s-podatki.html"><a href="slovnica-ravnanja-s-podatki.html#domača-naloga"><i class="fa fa-check"></i><b>1.16</b> Domača naloga</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html"><i class="fa fa-check"></i><b>2</b> Urejeni in relacijski podatki</a>
<ul>
<li class="chapter" data-level="2.1" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#priprava-1"><i class="fa fa-check"></i><b>2.1</b> Priprava</a></li>
<li class="chapter" data-level="2.2" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#urejeni-podatki"><i class="fa fa-check"></i><b>2.2</b> Urejeni podatki</a></li>
<li class="chapter" data-level="2.3" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#pivot_longer-pretvorba-v-daljšo-obliko"><i class="fa fa-check"></i><b>2.3</b> <code>pivot_longer()</code>: pretvorba v daljšo obliko</a></li>
<li class="chapter" data-level="2.4" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#pivot_wider-pretvorba-v-širšo-obliko"><i class="fa fa-check"></i><b>2.4</b> <code>pivot_wider()</code>: pretvorba v širšo obliko</a></li>
<li class="chapter" data-level="2.5" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#separate-in-unite-deljenje-in-združevanje-stolpcev"><i class="fa fa-check"></i><b>2.5</b> <code>separate()</code> in <code>unite()</code>: deljenje in združevanje stolpcev</a></li>
<li class="chapter" data-level="2.6" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#relacijske-zbirke-podatkov"><i class="fa fa-check"></i><b>2.6</b> Relacijske zbirke podatkov</a></li>
<li class="chapter" data-level="2.7" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#primer-bančni-podatki"><i class="fa fa-check"></i><b>2.7</b> Primer: Bančni podatki</a></li>
<li class="chapter" data-level="2.8" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#ključi"><i class="fa fa-check"></i><b>2.8</b> Ključi</a></li>
<li class="chapter" data-level="2.9" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#združevanja"><i class="fa fa-check"></i><b>2.9</b> Združevanja</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#mutirajoča-združevanja"><i class="fa fa-check"></i><b>2.9.1</b> Mutirajoča združevanja</a></li>
<li class="chapter" data-level="2.9.2" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#argument-by"><i class="fa fa-check"></i><b>2.9.2</b> Argument <code>by</code></a></li>
<li class="chapter" data-level="2.9.3" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#filtrirajoča-združevanja"><i class="fa fa-check"></i><b>2.9.3</b> Filtrirajoča združevanja</a></li>
<li class="chapter" data-level="2.9.4" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#združevanja-na-realnih-podatkih"><i class="fa fa-check"></i><b>2.9.4</b> Združevanja na realnih podatkih</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#operacije-nad-množicami"><i class="fa fa-check"></i><b>2.10</b> Operacije nad množicami</a></li>
<li class="chapter" data-level="2.11" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#ali-želite-izvedeti-več-1"><i class="fa fa-check"></i><b>2.11</b> Ali želite izvedeti več?</a></li>
<li class="chapter" data-level="2.12" data-path="urejeni-in-relacijski-podatki.html"><a href="urejeni-in-relacijski-podatki.html#domača-naloga-1"><i class="fa fa-check"></i><b>2.12</b> Domača naloga</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html"><i class="fa fa-check"></i><b>3</b> Nizi, kategorične spremenljivke in datumi</a>
<ul>
<li class="chapter" data-level="3.1" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#priprava-2"><i class="fa fa-check"></i><b>3.1</b> Priprava</a>
<ul>
<li class="chapter" data-level="" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#delo-s-šumniki"><i class="fa fa-check"></i>Delo s šumniki</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#nizi-1"><i class="fa fa-check"></i><b>3.2</b> Nizi</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#podnizi"><i class="fa fa-check"></i><b>3.2.1</b> Podnizi</a></li>
<li class="chapter" data-level="3.2.2" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#iskanje-vzorcev-z-regularnimi-izrazi"><i class="fa fa-check"></i><b>3.2.2</b> Iskanje vzorcev z regularnimi izrazi</a></li>
<li class="chapter" data-level="3.2.3" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#ponovitve"><i class="fa fa-check"></i><b>3.2.3</b> Ponovitve</a></li>
<li class="chapter" data-level="3.2.4" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#skupine"><i class="fa fa-check"></i><b>3.2.4</b> Skupine</a></li>
<li class="chapter" data-level="3.2.5" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#uporaba-regularnih-izrazov"><i class="fa fa-check"></i><b>3.2.5</b> Uporaba regularnih izrazov</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#kategorične-spremenljivke-1"><i class="fa fa-check"></i><b>3.3</b> Kategorične spremenljivke</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#sprememba-razvrstitve-faktorja"><i class="fa fa-check"></i><b>3.3.1</b> Sprememba razvrstitve faktorja</a></li>
<li class="chapter" data-level="3.3.2" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#preimenivanje-obstoječih-nivojev"><i class="fa fa-check"></i><b>3.3.2</b> Preimenivanje obstoječih nivojev</a></li>
<li class="chapter" data-level="3.3.3" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#razbitje-numerične-spremenljivke-na-intervale"><i class="fa fa-check"></i><b>3.3.3</b> Razbitje numerične spremenljivke na intervale</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#datumi-in-ure"><i class="fa fa-check"></i><b>3.4</b> Datumi in ure</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#računanje-z-datumi-in-časi"><i class="fa fa-check"></i><b>3.4.1</b> Računanje z datumi in časi</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#shranjevanje-in-branje-podatkov"><i class="fa fa-check"></i><b>3.5</b> Shranjevanje in branje podatkov</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#delo-z-binarnimi-datotekami"><i class="fa fa-check"></i><b>3.5.1</b> Delo z binarnimi datotekami</a></li>
<li class="chapter" data-level="3.5.2" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#branje-in-shranjevanje-z-ostalimi-datotekami"><i class="fa fa-check"></i><b>3.5.2</b> Branje in shranjevanje z ostalimi datotekami</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#ali-želite-izvedeti-več-2"><i class="fa fa-check"></i><b>3.6</b> Ali želite izvedeti več?</a></li>
<li class="chapter" data-level="3.7" data-path="nizi-kategori-ne-spremenljivke-in-datumi.html"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#domača-naloga-2"><i class="fa fa-check"></i><b>3.7</b> Domača naloga</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="reference.html"><a href="reference.html"><i class="fa fa-check"></i>Reference</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Urejanje podatkov</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nizi-kategorične-spremenljivke-in-datumi" class="section level1" number="3">
<h1><span class="header-section-number">Poglavje 3</span> Nizi, kategorične spremenljivke in datumi</h1>
<p>Pri delu s podatki se pogosto srečamo s posebnimi podatkovnimi tipi, kot so nizi, kategorične spremenljivke in datumi. Z nizi smo že delali v prvih dveh poglavjih. Delali smo tudi s kategoričnimi spremenljivkami, čeprav tega nismo poudarili. V tem poglavju bomo spoznali naprednejše operacije nad temi podatkovnimi tipi v okviru zbirke tidyverse ter predstavili praktične primere, dobre prakse in pasti pri delu z njimi.</p>
<p>Konec poglavja pa bomo posvetili branju in pisanju podatkov v različnih oblikah.</p>
<div id="priprava-2" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Priprava</h2>
<div id="nizi" class="section level4 unnumbered">
<h4>Nizi</h4>
<p>Najprej si poglejmo najbolj uporabne funkcije za delo z nizi.</p>
<p>Nize lahko združujemo na več načinov:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb6-1" aria-hidden="true" tabindex="-1"></a>crke      <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>)</span>
<span id="cb6-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb6-2" aria-hidden="true" tabindex="-1"></a>stevilke  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>, <span class="st">&quot;4&quot;</span>)</span>
<span id="cb6-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(crke, stevilke)</span></code></pre></div>
<pre><code>## [1] &quot;A1&quot; &quot;B2&quot; &quot;C3&quot; &quot;D4&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(crke, stevilke, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;A-1&quot; &quot;B-2&quot; &quot;C-3&quot; &quot;D-4&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(crke, stevilke, <span class="at">collapse =</span> <span class="st">&quot;-&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;A1-B2-C3-D4&quot;</code></pre>
<p>Obratno jih lahko razčlenimo na več manjših nizov:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_split</span>(<span class="st">&quot;A1-B2-C3-D4&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;-&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;A1&quot; &quot;B2&quot; &quot;C3&quot; &quot;D4&quot;</code></pre>
<p>Zelo uporabna je tudi funkcija za zamenjavo podnizov.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace</span>(<span class="st">&quot;A1-B1-A2-B2&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;(ena)&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;A(ena)-B1-A2-B2&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace_all</span>(<span class="st">&quot;A1-B1-A2-B2&quot;</span>, <span class="at">pattern =</span> <span class="st">&quot;1&quot;</span>, <span class="st">&quot;(ena)&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;A(ena)-B(ena)-A2-B2&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace_all</span>(<span class="st">&quot;A1-B1-A2-B2&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;(ena)&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;(dva)&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;A(ena)-B(ena)-A(dva)-B(dva)&quot;</code></pre>
<p>Poglejmo, kako bi iz zbirke sadežev v že vgrajenem nizu <code>fruit</code> poiskali vse nize, ki vsebujejo <code>berry</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(fruit)</span></code></pre></div>
<pre><code>## [1] 80</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_subset</span>(fruit, <span class="st">&quot;berry&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;bilberry&quot;    &quot;blackberry&quot;  &quot;blueberry&quot;   &quot;boysenberry&quot; &quot;cloudberry&quot; 
##  [6] &quot;cranberry&quot;   &quot;elderberry&quot;  &quot;goji berry&quot;  &quot;gooseberry&quot;  &quot;huckleberry&quot;
## [11] &quot;mulberry&quot;    &quot;raspberry&quot;   &quot;salal berry&quot; &quot;strawberry&quot;</code></pre>
<p>Podobno lahko vrnemo logični vektor nizov, ki vsebujejo <code>berry</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(fruit, <span class="st">&quot;berry&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE FALSE
## [13] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE
## [25] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE
## [37] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [49] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE
## [73]  TRUE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE</code></pre>
<p>Funkcija <code>str_detect()</code> je zelo uporabna pri izbiranju vrstic glede na nize. Običajno jo uporabljamo v kombinaciji z regularnimi izrazi, ki jih bomo spoznali v jedru tega poglavja.</p>
</div>
<div id="kategorične-spremenljivke" class="section level4 unnumbered">
<h4>Kategorične spremenljivke</h4>
<p>Pri pripravi na kategorične spremenljivke bomo uporabili podatke o uspehu študentov na izpitu:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-1" aria-hidden="true" tabindex="-1"></a>tib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ime             =</span> <span class="fu">c</span>(<span class="st">&quot;Maja&quot;</span>, <span class="st">&quot;Ales&quot;</span>, <span class="st">&quot;Tom&quot;</span>, <span class="st">&quot;Barbara&quot;</span>, <span class="st">&quot;Simon&quot;</span>, <span class="st">&quot;Tina&quot;</span>),</span>
<span id="cb26-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">spol            =</span> <span class="fu">c</span>(<span class="st">&quot;z&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;z&quot;</span>),</span>
<span id="cb26-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ocena           =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">7</span>),</span>
<span id="cb26-5"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dan_izpita      =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">8</span>, <span class="dv">23</span>),</span>
<span id="cb26-6"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mesec_izpita    =</span> <span class="fu">rep</span>(<span class="dv">6</span>, <span class="dv">6</span>),</span>
<span id="cb26-7"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">leto_izpita     =</span> <span class="fu">rep</span>(<span class="dv">2021</span>, <span class="dv">6</span>),</span>
<span id="cb26-8"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">opravljene_vaje =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb26-9"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">procenti_vaje   =</span> <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">65</span>, <span class="dv">80</span>, <span class="dv">90</span>, <span class="dv">30</span>, <span class="dv">75</span>)</span>
<span id="cb26-10"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-11"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb26-11" aria-hidden="true" tabindex="-1"></a>tib</span></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   ime     spol  ocena dan_izpita mesec_izpita leto_izpita opravljene_vaje
##   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
## 1 Maja    z        10          8            6        2021               1
## 2 Ales    m        10          8            6        2021               1
## 3 Tom     m         6         16            6        2021               1
## 4 Barbara z         8         16            6        2021               1
## 5 Simon   m         8          8            6        2021               0
## 6 Tina    z         7         23            6        2021               1
## # ... with 1 more variable: procenti_vaje &lt;dbl&gt;</code></pre>
<p>Spremenimo <strong>spol</strong> v nominalno spremenljivko (brez ureditve) in <strong>oceno</strong> v ordinalno spremenljivko (obstaja vrsti red vrednosti):</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb28-1" aria-hidden="true" tabindex="-1"></a>tib <span class="ot">&lt;-</span> tib <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">spol  =</span> <span class="fu">factor</span>(spol),</span>
<span id="cb28-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb28-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ocena =</span> <span class="fu">factor</span>(ocena, <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb28-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb28-3" aria-hidden="true" tabindex="-1"></a>tib<span class="sc">$</span>spol</span></code></pre></div>
<pre><code>## [1] z m m z m z
## Levels: m z</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb30-1" aria-hidden="true" tabindex="-1"></a>tib<span class="sc">$</span>ocena</span></code></pre></div>
<pre><code>## [1] 10 10 6  8  8  7 
## Levels: 6 &lt; 7 &lt; 8 &lt; 10</code></pre>
<p>Nivoje faktorja (levels) lahko uredimo tudi glede na vrednosti v nekem drugem stolpcu. To običajno pride prav pri vizualizaciji.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb32-1" aria-hidden="true" tabindex="-1"></a>tib <span class="ot">&lt;-</span> tib <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">spol =</span> <span class="fu">fct_reorder</span>(spol, procenti_vaje, <span class="at">.desc =</span> <span class="cn">TRUE</span>))</span>
<span id="cb32-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb32-3" aria-hidden="true" tabindex="-1"></a>tib<span class="sc">$</span>spol</span></code></pre></div>
<pre><code>## [1] z m m z m z
## Levels: z m</code></pre>
</div>
<div id="datumi" class="section level4 unnumbered">
<h4>Datumi</h4>
<p>Za delo z datumi bomo uporabljali paket <strong>lubridate</strong>. Datume lahko z lubridate shranimo na več načinov. Preprosto lahko sestavimo datum s posameznimi komponentami:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb34-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make_date</span>(<span class="at">year =</span> <span class="dv">2021</span>, <span class="at">month =</span> <span class="dv">6</span>, <span class="at">day =</span> <span class="dv">11</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-11&quot;</code></pre>
<p>Ali iz niza:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">&quot;2021-06-11&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-11&quot;</code></pre>
<p>Lahko dodamo tudi čas:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_datetime</span>(<span class="at">year =</span> <span class="dv">2021</span>, <span class="at">month =</span> <span class="dv">6</span>, <span class="at">day =</span> <span class="dv">11</span>, <span class="at">hour =</span> <span class="dv">11</span>, <span class="at">min =</span> <span class="dv">30</span>, <span class="at">tz =</span> <span class="st">&quot;CET&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-11 11:30:00 CEST&quot;</code></pre>
<p>Z datumi lahko tudi računamo:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb40-1" aria-hidden="true" tabindex="-1"></a>my_date <span class="ot">&lt;-</span> <span class="fu">make_date</span>(<span class="at">year =</span> <span class="dv">2021</span>, <span class="at">month =</span> <span class="dv">6</span>, <span class="at">day =</span> <span class="dv">11</span>)</span>
<span id="cb40-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb40-2" aria-hidden="true" tabindex="-1"></a>my_date</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-11&quot;</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb42-1" aria-hidden="true" tabindex="-1"></a>my_date <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-13&quot;</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb44-1" aria-hidden="true" tabindex="-1"></a>my_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-09-11&quot;</code></pre>
</div>
<div id="shranjevanje-podatkov-v-csv" class="section level4 unnumbered">
<h4>Shranjevanje podatkov v csv</h4>
<p>V pripravi v 2. poglavju smo že spoznali funkcijo <code>rear_csv2()</code> za branje podatkov iz tekstovnih datotek. Podatke lahko tudi shranimo v tekstovno datoteko s funkcijo <code>write_csv2()</code>:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv2</span>(tib, <span class="st">&quot;./data-raw/studenti.csv&quot;</span>)</span></code></pre></div>
<p><strong>Naloga 1</strong>: Datoteko <em>ocene.csv</em> v mapi <em>data-raw</em> preberite s funkcijami paketa <strong>readr</strong> (<code>read_csv2()</code> in <code>write_csv2()</code>). Shranite jo kot <em>ocene2.csv</em> in to datoteko preberite nazaj. Nato naredite enako z baznimi funkcijami v R (<code>read.csv2()</code> in <code>write.csv2()</code>). Kaj opazite?</p>
<p>Z <strong>readr</strong>:</p>
<pre><code>## # A tibble: 6 x 7
##   ime     spol  ocena dan_izpita mesec_izpita leto_izpita opravljene_vaje
##   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
## 1 Maja    z         7          8            6        2021               1
## 2 Ales    m        10          8            6        2021               1
## 3 Tom     m         6         16            6        2021               1
## 4 Barbara z         8         16            6        2021               1
## 5 Simon   m         8          8            6        2021               0
## 6 Tina    z         7         23            6        2021               1</code></pre>
<p>Z R:</p>
<pre><code>##   X     ime spol ocena dan_izpita mesec_izpita leto_izpita opravljene_vaje
## 1 1    Maja    z     7          8            6        2021               1
## 2 2    Ales    m    10          8            6        2021               1
## 3 3     Tom    m     6         16            6        2021               1
## 4 4 Barbara    z     8         16            6        2021               1
## 5 5   Simon    m     8          8            6        2021               0
## 6 6    Tina    z     7         23            6        2021               1</code></pre>
<p><strong>Naloga 2</strong>: Ponovno preberite <em>ocene.csv</em> ter:</p>
<ul>
<li>spremenite stolpec <code>opravljene_vaje</code> v kategorične vrednosti,</li>
<li>zamenjajte stolpce <code>leto_izpita</code>, <code>mesec_izpita</code>, <code>dan_izpita</code> z <code>datum_izpita</code>, ki vsebuje vse te podatke,</li>
<li>izberite samo imena, ki se začnejo na ‘T’ in podatke shranite v datoteko oceneT.csv.</li>
</ul>
<pre><code>##    ime spol ocena opravljene_vaje datum_izpita
## 1  Tom    m     6               1   2021-06-16
## 2 Tina    z     7               1   2021-06-23</code></pre>
</div>
<div id="delo-s-šumniki" class="section level3 unnumbered">
<h3>Delo s šumniki</h3>
<p>Pri delu z nizi RStudio uporablja privzeto kodiranje vašega operacijskega sistema. Preprost način, da preverite, ali R uporablja pravilno kodiranje, je, da v konzolo napišete “čebula.” Nazaj morate dobiti enak niz in ne “cebula” ali celo “პbula.”</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;čebula&quot;</span></span></code></pre></div>
<pre><code>## [1] &quot;čebula&quot;</code></pre>
<p>Če R ne vrne istega niza, je potrebno nastaviti privzeto kodiranje na svojem operacijskem sistemu. Da vidimo, katero kodiranje je trenutno uporabljeno, lahko napišemo:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.getlocale</span>()</span></code></pre></div>
<pre><code>## [1] &quot;LC_COLLATE=Slovenian_Slovenia.1250;LC_CTYPE=Slovenian_Slovenia.1250;LC_MONETARY=Slovenian_Slovenia.1250;LC_NUMERIC=C;LC_TIME=Slovenian_Slovenia.1250&quot;</code></pre>
<p>Pri tem izpisu vidimo, da uporabljamo sloveski nabor znakov CP1250. Če imate težave, lahko to začasno spremenite z ukazom:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setlocale</span>(<span class="at">category =</span> <span class="st">&quot;LC_ALL&quot;</span>, <span class="at">locale =</span> <span class="st">&quot;Slovenian_Slovenia.1250&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;LC_COLLATE=Slovenian_Slovenia.1250;LC_CTYPE=Slovenian_Slovenia.1250;LC_MONETARY=Slovenian_Slovenia.1250;LC_NUMERIC=C;LC_TIME=Slovenian_Slovenia.1250&quot;</code></pre>
<p>Oziroma lahko na primer v OS Windows nastavite privzeto kodiranje pod “Settings -&gt; Time &amp; Language -&gt; Region -&gt; Regional Format.” Tukaj izberite “Slovenian (Slovenia).”</p>
<p>Za slovenski OS Windows: “Nastavitve -&gt; Ura in Jezik -&gt; Regija -&gt; Območne nastavitve” in izberite “Slovenščina (Slovenija).”</p>
</div>
</div>
<div id="nizi-1" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Nizi</h2>
<p>Zbirka paketov tidyverse vsebuje paket <strong>stringr</strong>, ki je namenjen delu z nizi. Vsi ukazi v paketu se začnejo s <code>str_</code>, kar v kombinaciji s funkcionalnostjo avtomatskega dopolnjevanja omogoča hitro izbiro in pregled vseh funkcij.</p>
<p>V jeziku R lahko za definiranje niza uporabimo enojne (’) ali dvojne navednice ("). R bo rezultat sicer vedno vrnil v dvojnih navednicah.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb56-1" aria-hidden="true" tabindex="-1"></a>niz_dvojne_navednice <span class="ot">&lt;-</span> <span class="st">&quot;urejanje podatkov&quot;</span></span>
<span id="cb56-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb56-2" aria-hidden="true" tabindex="-1"></a>niz_enojne_navednice <span class="ot">&lt;-</span> <span class="st">&#39;urejanje podatkov&#39;</span></span>
<span id="cb56-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb56-3" aria-hidden="true" tabindex="-1"></a>niz_dvojne_navednice</span></code></pre></div>
<pre><code>## [1] &quot;urejanje podatkov&quot;</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb58-1" aria-hidden="true" tabindex="-1"></a>niz_enojne_navednice</span></code></pre></div>
<pre><code>## [1] &quot;urejanje podatkov&quot;</code></pre>
<p>Če želimo znotraj niza uporabiti dvojne navednice, lahko za definicijo uporabljamo enojne in obratno:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb60-1" aria-hidden="true" tabindex="-1"></a>citat1 <span class="ot">&lt;-</span> <span class="st">&quot;Jure je rekel: &#39;Citiram Janeza&#39;.&quot;</span></span>
<span id="cb60-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb60-2" aria-hidden="true" tabindex="-1"></a>citat2 <span class="ot">&lt;-</span> <span class="st">&#39;In Janez je rekel: &quot;Citiram Jureta&quot;.&#39;</span></span>
<span id="cb60-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb60-3" aria-hidden="true" tabindex="-1"></a>citat1</span></code></pre></div>
<pre><code>## [1] &quot;Jure je rekel: &#39;Citiram Janeza&#39;.&quot;</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb62-1" aria-hidden="true" tabindex="-1"></a>citat2</span></code></pre></div>
<pre><code>## [1] &quot;In Janez je rekel: \&quot;Citiram Jureta\&quot;.&quot;</code></pre>
<p>Izpis v drugem primeru uporablja tako imenovan <strong>escape character</strong> (\), ki omogoča tudi vpis tabulaterjev (\t), znakov za novo vrstico (\n) in podobno. Vse znake, ki jih je tako možno zapisati, si lahko ogledate z ukazom <code>?"'"</code>.</p>
<p>Niz lahko vključuje tudi vse posebne znake, ki jih podpira Unicode. To je standard za konsistentno kodiranje teksta, ki vsebuje preko 100000 znakov. Za vnos znakov unicode uporabite <strong>\uxxxx</strong>, kjer je <strong>xxxx</strong> koda znaka, ki ga lahko poiščete na strani <a href="https://unicode.org/charts/" class="uri">https://unicode.org/charts/</a>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb64-1" aria-hidden="true" tabindex="-1"></a>normalna_porazdelitev <span class="ot">&lt;-</span> <span class="st">&quot;Normal(\u03BC, 1)&quot;</span></span>
<span id="cb64-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb64-2" aria-hidden="true" tabindex="-1"></a>normalna_porazdelitev</span></code></pre></div>
<pre><code>## [1] &quot;Normal(µ, 1)&quot;</code></pre>
<p>Dolžino nizov poiščemo s funkcijo <code>str_length()</code>:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_length</span>(<span class="fu">c</span>(<span class="st">&quot;tri&quot;</span>, <span class="st">&quot;štiri&quot;</span>, <span class="st">&quot;&quot;</span>, citat1, normalna_porazdelitev))</span></code></pre></div>
<pre><code>## [1]  3  5  0 32 12</code></pre>
<p>Za združevanje nizov se uporablja <code>str_c()</code>, ki mu lahko dodamo tudi niz <code>sep</code>, ki ga vrine med vse podane nize:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;paradižnik&quot;</span>, <span class="st">&quot;bučke&quot;</span>, <span class="st">&quot;jabolka&quot;</span>, <span class="st">&quot;paprika&quot;</span>, <span class="st">&quot;jagode&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;paradižnik, bučke, jabolka, paprika, jagode&quot;</code></pre>
<p>Če funkciji podamo vektorje lahko združimo tudi več nizov naenkrat. Pri tem bo število dobljenih nizov enako največjemu vektorju, manjši pa se bodo reciklirali, kar pomeni, da se bodo njihove vrednosti ponavljale, dokler ne dosežejo dolžine najdaljšega vektorja.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_c</span>(<span class="st">&quot;Podpoglavje &quot;</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="st">&quot;: &quot;</span>,</span>
<span id="cb70-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb70-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">&quot;Nizi&quot;</span>, <span class="st">&quot;Faktorji&quot;</span>, <span class="st">&quot;Datumi&quot;</span>, <span class="st">&quot;Branje podatkov&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Podpoglavje 1: Nizi&quot;            &quot;Podpoglavje 2: Faktorji&quot;       
## [3] &quot;Podpoglavje 3: Datumi&quot;          &quot;Podpoglavje 4: Branje podatkov&quot;</code></pre>
<p>Če želimo nize združiti zaporedno uporabimo <code>collapse</code>. Za izpis nizov brez escape znakov uporabite funkcijo <code>cat()</code>:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb72-1" aria-hidden="true" tabindex="-1"></a>poglavja <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;Podpoglavje &quot;</span>, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="st">&quot;: &quot;</span>,</span>
<span id="cb72-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb72-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="st">&quot;Nizi&quot;</span>, <span class="st">&quot;Faktorji&quot;</span>, <span class="st">&quot;Datumi&quot;</span>, <span class="st">&quot;Branje podatkov&quot;</span>), <span class="at">collapse =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb72-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb72-3" aria-hidden="true" tabindex="-1"></a>poglavja</span></code></pre></div>
<pre><code>## [1] &quot;Podpoglavje 1: Nizi\nPodpoglavje 2: Faktorji\nPodpoglavje 3: Datumi\nPodpoglavje 4: Branje podatkov&quot;</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(poglavja)</span></code></pre></div>
<pre><code>## Podpoglavje 1: Nizi
## Podpoglavje 2: Faktorji
## Podpoglavje 3: Datumi
## Podpoglavje 4: Branje podatkov</code></pre>
<p>Manjkajoče vrednosti lahko zamenjamo s <code>str_replace_na()</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace_na</span>(<span class="fu">c</span>(<span class="st">&quot;ena&quot;</span>, <span class="st">&quot;dva&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;štiri&quot;</span>), <span class="at">replacement =</span> <span class="st">&quot;tri!&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ena&quot;   &quot;dva&quot;   &quot;tri!&quot;  &quot;štiri&quot;</code></pre>
<div id="podnizi" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Podnizi</h3>
<p>Velikokrat pri delu z nizi potrebujemo le del niza ali pa želimo niz razdeliti na več manjših nizov. Poglejmo si na primeru niza <code>"    KUPI: paradižnik, bučke, jabolka, paprika, jagode.  "</code>, iz katerega želimo dobiti vektor sadja in zelenjave:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb78-1" aria-hidden="true" tabindex="-1"></a>listek <span class="ot">&lt;-</span> <span class="st">&quot;    KUPI: paradižnik, bučke, jabolka, paprika, jagode.  &quot;</span></span></code></pre></div>
<p>Najprej odstranimo odvečne začetne in končne presledke. To storimo s <code>str_trim()</code>:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb79-1" aria-hidden="true" tabindex="-1"></a>listek <span class="ot">&lt;-</span> <span class="fu">str_trim</span>(listek)</span>
<span id="cb79-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb79-2" aria-hidden="true" tabindex="-1"></a>listek</span></code></pre></div>
<pre><code>## [1] &quot;KUPI: paradižnik, bučke, jabolka, paprika, jagode.&quot;</code></pre>
<p>Funkcija <code>str_sub()</code> vrne podniz glede na indekse znakov:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(listek, <span class="dv">7</span>, <span class="dv">16</span>) <span class="co"># Vrne znake med indeksom 7 do 16.</span></span></code></pre></div>
<pre><code>## [1] &quot;paradižnik&quot;</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(listek, <span class="dv">7</span>) <span class="co"># Vrne znake od sedmega naprej.</span></span></code></pre></div>
<pre><code>## [1] &quot;paradižnik, bučke, jabolka, paprika, jagode.&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(listek, <span class="sc">-</span><span class="dv">7</span>) <span class="co"># Vrne zadnjih sedem znakov.</span></span></code></pre></div>
<pre><code>## [1] &quot;jagode.&quot;</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(listek, <span class="sc">-</span><span class="dv">7</span>, <span class="sc">-</span><span class="dv">2</span>) <span class="co"># Vrne predzadnjih šest znakov.</span></span></code></pre></div>
<pre><code>## [1] &quot;jagode&quot;</code></pre>
<p>S tem znanjem lahko odstranimo prvih šest znakov in zadnjega:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb89-1" aria-hidden="true" tabindex="-1"></a>listek <span class="ot">&lt;-</span> <span class="fu">str_sub</span>(listek, <span class="dv">7</span>, <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb89-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb89-2" aria-hidden="true" tabindex="-1"></a>listek</span></code></pre></div>
<pre><code>## [1] &quot;paradižnik, bučke, jabolka, paprika, jagode&quot;</code></pre>
<p>Sedaj, ko imamo elemente samo naštete in ločene z vejico, jih lahko preprosto razdelimo s funkcijo <code>str_split()</code>, ki ji podamo vzorec za ločevanje:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_split</span>(listek, <span class="at">pattern =</span> <span class="st">&quot;, &quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;paradižnik&quot; &quot;bučke&quot;      &quot;jabolka&quot;    &quot;paprika&quot;    &quot;jagode&quot;</code></pre>
</div>
<div id="iskanje-vzorcev-z-regularnimi-izrazi" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Iskanje vzorcev z regularnimi izrazi</h3>
<p>Regularni izrazi so močno orodje za iskanje poljubnega vzorca v nizih. V tem poglavju bo predstavljena le osnovna funkcionalnost regularnih izrazov, saj gre za zelo obširno orodje. Za prikaz delovanja bomo uporabljali funkciji <code>str_view()</code> in <code>str_view_all()</code>, ki uporabljata paket <strong>htmlwidgets</strong> za prikaz rezultatov. Prva označi samo prvo ujemanje, druga pa vsa ujemanja.</p>
<p>Regularni izrazi so nizi, ki določijo iskalni vzorec. Z njimi lahko, na primer, iščemo nize, ki se začnejo na določen podniz, končajo na določen podniz, vsebujejo posebne simbole in podobno. Uporabljamo jih lahko v vseh funkcijah paketa <strong>stringr</strong>, ki imajo kot vhod <code>pattern</code>.</p>
<p>Sestavimo dva seznama v katerih bomo iskali vzorce. Za začetek poiščimo vse vejice.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb93-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb93-2" aria-hidden="true" tabindex="-1"></a>listek1 <span class="ot">&lt;-</span> <span class="st">&quot;KUPI: paradižnik, bučke, jabolka, paprika, jagode. Aja, pa banane.&quot;</span></span>
<span id="cb93-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb93-3" aria-hidden="true" tabindex="-1"></a>listek2 <span class="ot">&lt;-</span> <span class="st">&quot;KUPI: sok(3x), kruh, piškote, pašto(2x), sol in poper.&quot;</span></span>
<span id="cb93-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-8c6707a7d27c3ec166f8" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-8c6707a7d27c3ec166f8">{"x":{"html":"<ul>\n  <li>KUPI: paradižnik<span class='match'>,<\/span> bučke<span class='match'>,<\/span> jabolka<span class='match'>,<\/span> paprika<span class='match'>,<\/span> jagode. Aja<span class='match'>,<\/span> pa banane.<\/li>\n  <li>KUPI: sok(3x)<span class='match'>,<\/span> kruh<span class='match'>,<\/span> piškote<span class='match'>,<\/span> pašto(2x)<span class='match'>,<\/span> sol in poper.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Kaj pa pike?</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-9cc15b53aa780afaedb1" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-9cc15b53aa780afaedb1">{"x":{"html":"<ul>\n  <li><span class='match'>K<\/span><span class='match'>U<\/span><span class='match'>P<\/span><span class='match'>I<\/span><span class='match'>:<\/span><span class='match'> <\/span><span class='match'>p<\/span><span class='match'>a<\/span><span class='match'>r<\/span><span class='match'>a<\/span><span class='match'>d<\/span><span class='match'>i<\/span><span class='match'>ž<\/span><span class='match'>n<\/span><span class='match'>i<\/span><span class='match'>k<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>b<\/span><span class='match'>u<\/span><span class='match'>č<\/span><span class='match'>k<\/span><span class='match'>e<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>j<\/span><span class='match'>a<\/span><span class='match'>b<\/span><span class='match'>o<\/span><span class='match'>l<\/span><span class='match'>k<\/span><span class='match'>a<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>p<\/span><span class='match'>a<\/span><span class='match'>p<\/span><span class='match'>r<\/span><span class='match'>i<\/span><span class='match'>k<\/span><span class='match'>a<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>j<\/span><span class='match'>a<\/span><span class='match'>g<\/span><span class='match'>o<\/span><span class='match'>d<\/span><span class='match'>e<\/span><span class='match'>.<\/span><span class='match'> <\/span><span class='match'>A<\/span><span class='match'>j<\/span><span class='match'>a<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>p<\/span><span class='match'>a<\/span><span class='match'> <\/span><span class='match'>b<\/span><span class='match'>a<\/span><span class='match'>n<\/span><span class='match'>a<\/span><span class='match'>n<\/span><span class='match'>e<\/span><span class='match'>.<\/span><\/li>\n  <li><span class='match'>K<\/span><span class='match'>U<\/span><span class='match'>P<\/span><span class='match'>I<\/span><span class='match'>:<\/span><span class='match'> <\/span><span class='match'>s<\/span><span class='match'>o<\/span><span class='match'>k<\/span><span class='match'>(<\/span><span class='match'>3<\/span><span class='match'>x<\/span><span class='match'>)<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>k<\/span><span class='match'>r<\/span><span class='match'>u<\/span><span class='match'>h<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>p<\/span><span class='match'>i<\/span><span class='match'>š<\/span><span class='match'>k<\/span><span class='match'>o<\/span><span class='match'>t<\/span><span class='match'>e<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>p<\/span><span class='match'>a<\/span><span class='match'>š<\/span><span class='match'>t<\/span><span class='match'>o<\/span><span class='match'>(<\/span><span class='match'>2<\/span><span class='match'>x<\/span><span class='match'>)<\/span><span class='match'>,<\/span><span class='match'> <\/span><span class='match'>s<\/span><span class='match'>o<\/span><span class='match'>l<\/span><span class='match'> <\/span><span class='match'>i<\/span><span class='match'>n<\/span><span class='match'> <\/span><span class='match'>p<\/span><span class='match'>o<\/span><span class='match'>p<\/span><span class='match'>e<\/span><span class='match'>r<\/span><span class='match'>.<\/span><\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Pika je poseben znak pri regularnih izrazih, ki predstavlja poljuben znak. Zato smo dobili ujemanja z vsemi črkami. Da lahko dejansko poiščemo pike in druge posebne znake moramo uporabiti znak escape <code>\</code>, s katerim programu sporočimo, naj simbola za tem ne prebere kot regularni izraz. Tukaj se nam nekoliko zaplete, ker je znak <code>\</code> že znak escape v R za tabulatorje (<code>\t</code>), nove vrstice (<code>\n</code>) itd. Zato, da vzorcu dejansko podamo <code>\.</code> moramo zapisati <code>\\.</code>. Tukaj si ponovno lahko pomagamo s funkcijo <code>cat()</code>, ki nam bo pokazala dejanski niz podan funkciji.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>) <span class="co"># Poglejmo kakšen niz bo dejansko sprejela funkcija str_view_all().</span></span></code></pre></div>
<pre><code>## \.</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-194bf1b772be50cf6841" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-194bf1b772be50cf6841">{"x":{"html":"<ul>\n  <li>KUPI: paradižnik, bučke, jabolka, paprika, jagode<span class='match'>.<\/span> Aja, pa banane<span class='match'>.<\/span><\/li>\n  <li>KUPI: sok(3x), kruh, piškote, pašto(2x), sol in poper<span class='match'>.<\/span><\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Regularni izrazi uporabljajo tudi dva posebna znaka, ki označujeta začetek <code>^</code> in konec <code>$</code> niza. Poiščimo samo pike, ki zaključujejo nize:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.$&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-a86aac90890fcb0f339f" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-a86aac90890fcb0f339f">{"x":{"html":"<ul>\n  <li>KUPI: paradižnik, bučke, jabolka, paprika, jagode. Aja, pa banane<span class='match'>.<\/span><\/li>\n  <li>KUPI: sok(3x), kruh, piškote, pašto(2x), sol in poper<span class='match'>.<\/span><\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>V regularnih izrazih so zelo uporabne tudi naslednje sekvence.</p>
<ul>
<li><code>\d</code>: Ujemanje s poljubno števko;</li>
<li><code>\s</code>: Ujemanje s poljubnim presledkom (presledek, tabulator, nova vrstica);</li>
<li><code>\b</code>: Ujemanje s prehodom iz besednih znakov (črke) na nebesedne (ločila, presledki).</li>
<li><code>[xyz]</code>: Ujemanje z x, y ali z;</li>
<li><code>[^xyz]</code>: Ujemanje z vsem razen x, y in z. Strešica znotraj oglatih oklepajev pomeni negacijo;</li>
<li><code>[[:digit:]]</code>: Ujemanje s poljubnim številom;</li>
<li><code>[[:alpha:]]</code>: Ujemanje s poljubno črko, uporabite lahko tudi <code>[[a-z]]</code> in <code>[[:lower:]]</code> za vse male črke ali <code>[[A-Z]]</code> in <code>[[:upper:]]</code> za vse velike črke;</li>
<li><code>[[:punct:]]</code>: Ujemanje z ločili.</li>
</ul>
<p>Poglejmo si uporabo nekaterih:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">dx&quot;</span>) <span class="co"># Poiščemo vse številke, ki jim sledi x.</span></span></code></pre></div>
<div id="htmlwidget-93a2c48f505f1c92bbb3" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-93a2c48f505f1c92bbb3">{"x":{"html":"<ul>\n  <li>KUPI: paradižnik, bučke, jabolka, paprika, jagode. Aja, pa banane.<\/li>\n  <li>KUPI: sok(<span class='match'>3x<\/span>), kruh, piškote, pašto(<span class='match'>2x<\/span>), sol in poper.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;[čžš]&quot;</span>) <span class="co"># Vse šumnike.</span></span></code></pre></div>
<div id="htmlwidget-a422e4b8a9402d180e47" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-a422e4b8a9402d180e47">{"x":{"html":"<ul>\n  <li>KUPI: paradi<span class='match'>ž<\/span>nik, bu<span class='match'>č<\/span>ke, jabolka, paprika, jagode. Aja, pa banane.<\/li>\n  <li>KUPI: sok(3x), kruh, pi<span class='match'>š<\/span>kote, pa<span class='match'>š<\/span>to(2x), sol in poper.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;[aA].[aA]&quot;</span>) <span class="co"># Dva a-ja s poljubnim znakom vmes.</span></span></code></pre></div>
<div id="htmlwidget-a98af81ce215c4fc23ba" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-a98af81ce215c4fc23ba">{"x":{"html":"<ul>\n  <li>KUPI: p<span class='match'>ara<\/span>dižnik, bučke, jabolka, paprika, jagode. <span class='match'>Aja<\/span>, pa b<span class='match'>ana<\/span>ne.<\/li>\n  <li>KUPI: sok(3x), kruh, piškote, pašto(2x), sol in poper.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;.[</span><span class="sc">\\</span><span class="st">s,.]&quot;</span>) <span class="co"># Vse konce besed.</span></span></code></pre></div>
<div id="htmlwidget-992687c18f9b50102729" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-992687c18f9b50102729">{"x":{"html":"<ul>\n  <li>KUPI<span class='match'>: <\/span>paradižni<span class='match'>k,<\/span> bučk<span class='match'>e,<\/span> jabolk<span class='match'>a,<\/span> paprik<span class='match'>a,<\/span> jagod<span class='match'>e.<\/span> Aj<span class='match'>a,<\/span> p<span class='match'>a <\/span>banan<span class='match'>e.<\/span><\/li>\n  <li>KUPI<span class='match'>: <\/span>sok(3x<span class='match'>),<\/span> kru<span class='match'>h,<\/span> piškot<span class='match'>e,<\/span> pašto(2x<span class='match'>),<\/span> so<span class='match'>l <\/span>i<span class='match'>n <\/span>pope<span class='match'>r.<\/span><\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;[a-f]&quot;</span>) <span class="co"># Vse črke od a do f.</span></span></code></pre></div>
<div id="htmlwidget-f37c7391487a6bdba241" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-f37c7391487a6bdba241">{"x":{"html":"<ul>\n  <li>KUPI: p<span class='match'>a<\/span>r<span class='match'>a<\/span><span class='match'>d<\/span>ižnik, <span class='match'>b<\/span>učk<span class='match'>e<\/span>, j<span class='match'>a<\/span><span class='match'>b<\/span>olk<span class='match'>a<\/span>, p<span class='match'>a<\/span>prik<span class='match'>a<\/span>, j<span class='match'>a<\/span>go<span class='match'>d<\/span><span class='match'>e<\/span>. Aj<span class='match'>a<\/span>, p<span class='match'>a<\/span> <span class='match'>b<\/span><span class='match'>a<\/span>n<span class='match'>a<\/span>n<span class='match'>e<\/span>.<\/li>\n  <li>KUPI: sok(3x), kruh, piškot<span class='match'>e<\/span>, p<span class='match'>a<\/span>što(2x), sol in pop<span class='match'>e<\/span>r.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;[[:punct:]]&quot;</span>) <span class="co"># Vsa ločila.</span></span></code></pre></div>
<div id="htmlwidget-57565aca7cb0f8583120" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-57565aca7cb0f8583120">{"x":{"html":"<ul>\n  <li>KUPI<span class='match'>:<\/span> paradižnik<span class='match'>,<\/span> bučke<span class='match'>,<\/span> jabolka<span class='match'>,<\/span> paprika<span class='match'>,<\/span> jagode<span class='match'>.<\/span> Aja<span class='match'>,<\/span> pa banane<span class='match'>.<\/span><\/li>\n  <li>KUPI<span class='match'>:<\/span> sok<span class='match'>(<\/span>3x<span class='match'>)<\/span><span class='match'>,<\/span> kruh<span class='match'>,<\/span> piškote<span class='match'>,<\/span> pašto<span class='match'>(<\/span>2x<span class='match'>)<\/span><span class='match'>,<\/span> sol in poper<span class='match'>.<\/span><\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Znotraj oglatih oklepajev je pomen pike dobeseden znak pika. Tako, da ga ni potrebno zapisati kot <code>\\.</code> Priporočamo, da sami preizkušate še druge sekvence.</p>
<p>Navpična črta <code>|</code> pomeni ali:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;sol|sok&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-dc8e76a785ad9fba4b33" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-dc8e76a785ad9fba4b33">{"x":{"html":"<ul>\n  <li>KUPI: paradižnik, bučke, jabolka, paprika, jagode. Aja, pa banane.<\/li>\n  <li>KUPI: <span class='match'>sok<\/span>(3x), kruh, piškote, pašto(2x), <span class='match'>sol<\/span> in poper.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="ponovitve" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Ponovitve</h3>
<p>Zelo uporabni so tudi ukazi za ponovitve znakov ali sekvenc, ki nam omogočajo iskanje nizov določenih dolžin. Ukazi za delo s ponovitvami so:</p>
<ul>
<li><code>?</code>: ponovi 0 ali 1 krat,</li>
<li><code>*</code>: ponovi 0 ali več krat,</li>
<li><code>+</code>: ponovi 1 ali več krat,</li>
<li><code>{n}</code>: ponovi natanko n krat,</li>
<li><code>{n,}</code>: ponovi n ali več krat,</li>
<li><code>{,m}</code>: ponovi m ali manj krat,</li>
<li><code>{n,m}</code>: ponovi med n in m krat.</li>
</ul>
<p>Če znak za ponovitev uporabimo za enim znakom pomeni to ponovitev prejšnjega znaka. Lahko pa ga uporabimo tudi za oglatimi ali navadnimi oklepaji. Navadni oklepaji ločijo del regularnega izraza, podobno kot smo navajeni pri računanju z oklepaji. Določajo pa tudi skupino, o kateri bomo več povedali v naslednjem poglavju. Oglati oklepaji določajo izbiro, se pravi ponoviti se mora vsaj en od naštetih znakov.</p>
<p>Poiščimo najprej vse podnize, kjer se “an” ponovi enkrat:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;(an){1}&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-6cf7be5f84c13c4a079a" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-6cf7be5f84c13c4a079a">{"x":{"html":"<ul>\n  <li>KUPI: paradižnik, bučke, jabolka, paprika, jagode. Aja, pa b<span class='match'>an<\/span><span class='match'>an<\/span>e.<\/li>\n  <li>KUPI: sok(3x), kruh, piškote, pašto(2x), sol in poper.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Poiščimo vse besede dolžine 3. Da določimo začetek in konec besede, uporabimo <code>\\b</code>, ki določa prehod med besednim in nebesednim znakom. Za tem izberemo poljuben nabor črk, ki se mora ponoviti 3-krat:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">b[:alpha:]{3}</span><span class="sc">\\</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-4209f3b2b9f828e6ac59" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-4209f3b2b9f828e6ac59">{"x":{"html":"<ul>\n  <li>KUPI: paradižnik, bučke, jabolka, paprika, jagode. <span class='match'>Aja<\/span>, pa banane.<\/li>\n  <li>KUPI: <span class='match'>sok<\/span>(3x), kruh, piškote, pašto(2x), <span class='match'>sol<\/span> in poper.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Poiščimo vse besede dolžine med 3 ali 5 znakov:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">b[:alpha:]{3,5}</span><span class="sc">\\</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-bb2c473c2d546467eb7a" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-bb2c473c2d546467eb7a">{"x":{"html":"<ul>\n  <li><span class='match'>KUPI<\/span>: paradižnik, <span class='match'>bučke<\/span>, jabolka, paprika, jagode. <span class='match'>Aja<\/span>, pa banane.<\/li>\n  <li><span class='match'>KUPI<\/span>: <span class='match'>sok<\/span>(3x), <span class='match'>kruh<\/span>, piškote, <span class='match'>pašto<\/span>(2x), <span class='match'>sol<\/span> in <span class='match'>poper<\/span>.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Poiščimo vse besede dolžine točno 3 ali 5 znakov. V tem primeru moramo uporabiti “ali”:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">b([:alpha:]{3}|[:alpha:]{5})</span><span class="sc">\\</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-4ce180db3d1ef84b49ff" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-4ce180db3d1ef84b49ff">{"x":{"html":"<ul>\n  <li>KUPI: paradižnik, <span class='match'>bučke<\/span>, jabolka, paprika, jagode. <span class='match'>Aja<\/span>, pa banane.<\/li>\n  <li>KUPI: <span class='match'>sok<\/span>(3x), kruh, piškote, <span class='match'>pašto<\/span>(2x), <span class='match'>sol<\/span> in <span class='match'>poper<\/span>.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Poskušajmo poiskati besede, ki se začnejo na p in končajo na k ali e.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view_all</span>(<span class="fu">c</span>(listek1, listek2), <span class="st">&quot;</span><span class="sc">\\</span><span class="st">bp[:alpha:]*[ke]</span><span class="sc">\\</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-5724f34b5183c38a005e" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-5724f34b5183c38a005e">{"x":{"html":"<ul>\n  <li>KUPI: <span class='match'>paradižnik<\/span>, bučke, jabolka, paprika, jagode. Aja, pa banane.<\/li>\n  <li>KUPI: sok(3x), kruh, <span class='match'>piškote<\/span>, pašto(2x), sol in poper.<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="skupine" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Skupine</h3>
<p>Kot smo že videli lahko uporabimo tudi oklepaje, da ločimo del regularnega izraza od ostalih simbolov. Oklepaji pa definirajo tudi skupino, na katero se lahko sklicujemo z <code>\x</code>, kjer je x zaporedna številka skupine.</p>
<p>Poglejmo si uporabo le tega na že vgrajenem vektorju sadja. Parameter <code>match = TRUE</code> nam vrne le nize, pri katerih je prišlo do ujemanja.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(fruit, <span class="st">&quot;(..)</span><span class="sc">\\</span><span class="st">1&quot;</span>, <span class="at">match =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-e803269eb211e236f220" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-e803269eb211e236f220">{"x":{"html":"<ul>\n  <li>b<span class='match'>anan<\/span>a<\/li>\n  <li><span class='match'>coco<\/span>nut<\/li>\n  <li><span class='match'>cucu<\/span>mber<\/li>\n  <li><span class='match'>juju<\/span>be<\/li>\n  <li><span class='match'>papa<\/span>ya<\/li>\n  <li>s<span class='match'>alal<\/span> berry<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
<p>Zgornji regularni izraz z <code>..</code> poišče dva poljubna znaka. Z <code>(..)</code> definiramo skupino. Z <code>\1</code> oziroma <code>\\1</code>, pa zahtevamo, da se na tem mestu še enkrat nahaja točno to kar je bilo med oklepaji.</p>
<p>Poiščimo imena sadežev, ki imajo vsaj dve (lahko različni) ponavljajoči si črki:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_view</span>(fruit, <span class="st">&quot;(.)</span><span class="sc">\\</span><span class="st">1.*(.)</span><span class="sc">\\</span><span class="st">2&quot;</span>, <span class="at">match =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div id="htmlwidget-55c965906fcc656fa154" style="width:960px;height:100%;" class="str_view html-widget"></div>
<script type="application/json" data-for="htmlwidget-55c965906fcc656fa154">{"x":{"html":"<ul>\n  <li>be<span class='match'>ll pepp<\/span>er<\/li>\n  <li>g<span class='match'>ooseberr<\/span>y<\/li>\n<\/ul>"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="uporaba-regularnih-izrazov" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Uporaba regularnih izrazov</h3>
<p>Uporabo regularnih izrazov si najprej pogljemo na preprostih podatkih, nato pa še na podatkih iz ankete.</p>
<p>Poiščimo sadje in zelenjavo, ki vsebuje šumnike:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb113-1" aria-hidden="true" tabindex="-1"></a>seznam <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;paradižnik&quot;</span>, <span class="st">&quot;bučke&quot;</span>, <span class="st">&quot;jabolka&quot;</span>, <span class="st">&quot;paprika&quot;</span>, <span class="st">&quot;jagode&quot;</span>);</span>
<span id="cb113-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_detect</span>(seznam, <span class="st">&quot;[čšž]&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<p>Če želimo namesto logičnega vektorja dobiti dejanska imena elementov, uporabimo <code>str_subset()</code>:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_subset</span>(seznam, <span class="st">&quot;[čšž]&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;paradižnik&quot; &quot;bučke&quot;</code></pre>
<p>Poglejmo, koliko samoglasnikov vsebuje vsaka beseda v seznamu. Pozor, funkcija <code>str_count()</code> ne zazna ponovitev, če se le-te prekrivajo:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_count</span>(seznam, <span class="st">&quot;[aeiou]&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 4 2 3 3 3</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_count</span>(<span class="st">&quot;ababa&quot;</span>, <span class="st">&quot;aba&quot;</span>) <span class="co"># Ne zazna dveh ponovitev, ker se prekrivata.</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>S funkcijo <code>str_locate()</code> vrnemo indekse lokacij najdenih vzorcev, s <code>str_extract()</code> pa dobimo ta vzorec oziroma podniz. S <code>str_match()</code> dobimo podskupine.</p>
<p>Poiščimo podnize do prvega šumnika.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_locate</span>(seznam, <span class="st">&quot;^.*[čšž]&quot;</span>)</span></code></pre></div>
<pre><code>##      start end
## [1,]     1   7
## [2,]     1   3
## [3,]    NA  NA
## [4,]    NA  NA
## [5,]    NA  NA</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(seznam, <span class="st">&quot;^.*[čšž]&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;paradiž&quot; &quot;buč&quot;     NA        NA        NA</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_match</span>(seznam, <span class="st">&quot;(^.*)([čšž])&quot;</span>)</span></code></pre></div>
<pre><code>##      [,1]      [,2]     [,3]
## [1,] &quot;paradiž&quot; &quot;paradi&quot; &quot;ž&quot; 
## [2,] &quot;buč&quot;     &quot;bu&quot;     &quot;č&quot; 
## [3,] NA        NA       NA  
## [4,] NA        NA       NA  
## [5,] NA        NA       NA</code></pre>
<p>V zadnjem primeru funkcija <code>str_match()</code> v prvem stolpcu vrne enako kot <code>str_extract()</code>, nato pa v naslednjih stolpcih vrne še vsako skupino posebej.</p>
<p>Preprosta in zelo uporabna pa je funkcija <code>str_replace()</code> oziroma <code>str_replace_all()</code>, s katero lahko zamenjamo dele nizov.</p>
<p>Prekrijmo šumnike z znaki “x”:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace</span>(seznam, <span class="st">&quot;[čšž]&quot;</span>, <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;paradixnik&quot; &quot;buxke&quot;      &quot;jabolka&quot;    &quot;paprika&quot;    &quot;jagode&quot;</code></pre>
<p>Podamo lahko tudi zamenjavo za več ujemanj:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_replace_all</span>(seznam, <span class="fu">c</span>(<span class="st">&quot;č&quot;</span> <span class="ot">=</span> <span class="st">&quot;c&quot;</span>, <span class="st">&quot;š&quot;</span> <span class="ot">=</span> <span class="st">&quot;s&quot;</span>, <span class="st">&quot;ž&quot;</span><span class="ot">=</span> <span class="st">&quot;z&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;paradiznik&quot; &quot;bucke&quot;      &quot;jabolka&quot;    &quot;paprika&quot;    &quot;jagode&quot;</code></pre>
<p>Poglejmo si sedaj še uporabo na realnih podatkih. Najprej naložimo podatke:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb131-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;./data-raw/DS-jobs.csv&quot;</span>)</span>
<span id="cb131-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb131-2" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="ot">&lt;-</span> <span class="fu">tibble</span>(ds_jobs)</span>
<span id="cb131-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb131-3" aria-hidden="true" tabindex="-1"></a>ds_jobs</span></code></pre></div>
<pre><code>## # A tibble: 4,523 x 17
##    Gender Country    Age EmploymentStatus     CurrentJobTitle   LanguageRecomme~
##    &lt;chr&gt;  &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;                &lt;chr&gt;             &lt;chr&gt;           
##  1 Female Austral~    43 Employed full-time   Business Analyst  Python          
##  2 Male   Russia      33 Employed full-time   Software Develop~ Python          
##  3 Male   Taiwan      26 Employed full-time   Software Develop~ Python          
##  4 Male   United ~    25 Employed part-time   Researcher        Python          
##  5 Male   United ~    33 Employed full-time   Scientist/Resear~ Matlab          
##  6 Male   Czech R~    21 Employed part-time   Other             Python          
##  7 Male   Russia      22 Employed full-time   Data Analyst      Python          
##  8 Male   Netherl~    51 Employed full-time   Engineer          R               
##  9 Male   Colombia    34 Employed full-time   Data Scientist    Python          
## 10 Male   Germany     41 Independent contrac~ Data Scientist    Python          
## # ... with 4,513 more rows, and 11 more variables: FormalEducation &lt;chr&gt;,
## #   Major &lt;chr&gt;, CompensationAmount &lt;dbl&gt;, CompensationCurrency &lt;chr&gt;,
## #   TimeGatheringData &lt;int&gt;, TimeModelBuilding &lt;dbl&gt;, TimeProduction &lt;dbl&gt;,
## #   TimeVisualizing &lt;dbl&gt;, TimeFindingInsights &lt;dbl&gt;, TimeOtherSelect &lt;int&gt;,
## #   ExchangeRate &lt;dbl&gt;</code></pre>
<p>Najbolj uporabna funkcija pri delu z nizi v podatkih je <code>str_detect()</code>, ki nam omogoča izbiro podmnožice vrstic. Pogosto jo kombiniramo z regularnimi izrazi. Poiščimo tiste vrstice, kjer imajo anketiranci več službenih nazivov. Ti so ločeni z znakom /:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb133-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb133-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CurrentJobTitle) <span class="sc">%&gt;%</span></span>
<span id="cb133-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(CurrentJobTitle, <span class="st">&quot;/&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 946 x 1
##    CurrentJobTitle                     
##    &lt;chr&gt;                               
##  1 Software Developer/Software Engineer
##  2 Software Developer/Software Engineer
##  3 Scientist/Researcher                
##  4 Software Developer/Software Engineer
##  5 Scientist/Researcher                
##  6 Scientist/Researcher                
##  7 Scientist/Researcher                
##  8 Scientist/Researcher                
##  9 Software Developer/Software Engineer
## 10 Scientist/Researcher                
## # ... with 936 more rows</code></pre>
<p>Izberimo samo tiste vrstice, kjer se <code>CurrentJobTitle</code> začne z “Data” in se <code>EmploymentStatus</code> konča s “full-time”:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb135-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EmploymentStatus, CurrentJobTitle) <span class="sc">%&gt;%</span></span>
<span id="cb135-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(CurrentJobTitle, <span class="st">&quot;^Data&quot;</span>),</span>
<span id="cb135-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb135-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">str_detect</span>(EmploymentStatus, <span class="st">&quot;full-time$&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1,679 x 2
##    EmploymentStatus   CurrentJobTitle
##    &lt;chr&gt;              &lt;chr&gt;          
##  1 Employed full-time Data Analyst   
##  2 Employed full-time Data Scientist 
##  3 Employed full-time Data Scientist 
##  4 Employed full-time Data Scientist 
##  5 Employed full-time Data Analyst   
##  6 Employed full-time Data Scientist 
##  7 Employed full-time Data Scientist 
##  8 Employed full-time Data Analyst   
##  9 Employed full-time Data Analyst   
## 10 Employed full-time Data Scientist 
## # ... with 1,669 more rows</code></pre>
<p>Včasih so nizi v podatkih predolgi, oziroma lahko brez škode za pomen izbrišemo del niza. Najlažje to naredimo tako, da ga zamenjamo s praznim nizom. Izbrišimo podnize “Employed”:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb137-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="ot">&lt;-</span> ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EmploymentStatus =</span> <span class="fu">str_replace</span>(EmploymentStatus, <span class="st">&quot;Employed &quot;</span>, <span class="st">&quot;&quot;</span>))</span>
<span id="cb137-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb137-3" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb137-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EmploymentStatus, CurrentJobTitle)</span></code></pre></div>
<pre><code>## # A tibble: 4,523 x 2
##    EmploymentStatus                              CurrentJobTitle                
##    &lt;chr&gt;                                         &lt;chr&gt;                          
##  1 full-time                                     Business Analyst               
##  2 full-time                                     Software Developer/Software En~
##  3 full-time                                     Software Developer/Software En~
##  4 part-time                                     Researcher                     
##  5 full-time                                     Scientist/Researcher           
##  6 part-time                                     Other                          
##  7 full-time                                     Data Analyst                   
##  8 full-time                                     Engineer                       
##  9 full-time                                     Data Scientist                 
## 10 Independent contractor, freelancer, or self-~ Data Scientist                 
## # ... with 4,513 more rows</code></pre>
<p>Sedaj imamo eno manjšo nekonsistentnost v podatkih. Nekateri nizi se začnejo z veliko začetnico, nekateri pa z malo. Spremenimo vse na malo začetnico:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb139-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="ot">&lt;-</span> ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb139-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EmploymentStatus =</span> <span class="fu">str_to_lower</span>(EmploymentStatus))</span>
<span id="cb139-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb139-3" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb139-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EmploymentStatus, CurrentJobTitle)</span></code></pre></div>
<pre><code>## # A tibble: 4,523 x 2
##    EmploymentStatus                              CurrentJobTitle                
##    &lt;chr&gt;                                         &lt;chr&gt;                          
##  1 full-time                                     Business Analyst               
##  2 full-time                                     Software Developer/Software En~
##  3 full-time                                     Software Developer/Software En~
##  4 part-time                                     Researcher                     
##  5 full-time                                     Scientist/Researcher           
##  6 part-time                                     Other                          
##  7 full-time                                     Data Analyst                   
##  8 full-time                                     Engineer                       
##  9 full-time                                     Data Scientist                 
## 10 independent contractor, freelancer, or self-~ Data Scientist                 
## # ... with 4,513 more rows</code></pre>
<p>Funkcijo <code>str_count()</code> lahko uporabimo, da anketirancem dodamo stolpec s številom službenih nazivov:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb141-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CurrentJobTitle) <span class="sc">%&gt;%</span></span>
<span id="cb141-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NumberOfJobTitles =</span> <span class="fu">str_count</span>(CurrentJobTitle, <span class="st">&quot;/&quot;</span>) <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4,523 x 2
##    CurrentJobTitle                      NumberOfJobTitles
##    &lt;chr&gt;                                            &lt;dbl&gt;
##  1 Business Analyst                                     1
##  2 Software Developer/Software Engineer                 2
##  3 Software Developer/Software Engineer                 2
##  4 Researcher                                           1
##  5 Scientist/Researcher                                 2
##  6 Other                                                1
##  7 Data Analyst                                         1
##  8 Engineer                                             1
##  9 Data Scientist                                       1
## 10 Data Scientist                                       1
## # ... with 4,513 more rows</code></pre>
<p>Poskušajmo razdeliti CurrentJobTitle na FirstTitle in SecondTitle, pri tem naj se naziva ponovita, če ima anketiranec samo enega.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb143-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb143-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CurrentJobTitle) <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">FirstTitle  =</span> <span class="fu">str_extract</span>(CurrentJobTitle, <span class="st">&quot;^[^/]*&quot;</span>),</span>
<span id="cb143-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb143-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">SecondTitle =</span> <span class="fu">str_extract</span>(CurrentJobTitle, <span class="st">&quot;[^/]*$&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 4,523 x 3
##    CurrentJobTitle                      FirstTitle         SecondTitle      
##    &lt;chr&gt;                                &lt;chr&gt;              &lt;chr&gt;            
##  1 Business Analyst                     Business Analyst   Business Analyst 
##  2 Software Developer/Software Engineer Software Developer Software Engineer
##  3 Software Developer/Software Engineer Software Developer Software Engineer
##  4 Researcher                           Researcher         Researcher       
##  5 Scientist/Researcher                 Scientist          Researcher       
##  6 Other                                Other              Other            
##  7 Data Analyst                         Data Analyst       Data Analyst     
##  8 Engineer                             Engineer           Engineer         
##  9 Data Scientist                       Data Scientist     Data Scientist   
## 10 Data Scientist                       Data Scientist     Data Scientist   
## # ... with 4,513 more rows</code></pre>
</div>
</div>
<div id="kategorične-spremenljivke-1" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Kategorične spremenljivke</h2>
<p>Kategorične spremenljivke so spremenljivke, ki lahko zavzamejo samo končno mnogo vnaprej določenih vrednosti. Najbolj pogoste so:</p>
<ul>
<li><strong>Nominalne spremenljivke</strong>. To so spremenljivke brez ureditve: tip izdelka ali znamka avtomobila.</li>
<li><strong>Ordinalne spremenljivke</strong>. To so spremenljivke, ki imajo smiselno ureditev: stopnja izobrazbe ali šolski uspeh.</li>
</ul>
<p>V R uporabljamo za delo s kategoričnimi spremenljivkami t. i. <strong>faktorje</strong> (ang. <strong>factor</strong>). Ti se od spremenljivk tipa niz razlikujejo v tem, da se v spremenljivki hrani informacija o vseh možnih vrednostih. Faktorju ni mogoče dodati vrednosti, ki je ni v množici možnih vrednosti, kar služi kot varovalka pred napakami pri vnosu podatkov.</p>
<p>Poglejmo si uporabo faktorja na dveh preprostih primerih, kjer bomo sami ustvarili spremenljivki. Kasneje si bomo pogledali še delo s faktorji na primeru realnih podatkov, kjer bomo ponovno uporabili podatke o zaposlitvah na področju podatkovnih ved.</p>
<p>Kot primer nominalne spremenljivke si oglejmo krvne skupine. Obstajajo 4 možne vrednosti. Ustvarimo vektor krvnih skupin za pet različnih oseb:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb145-1" aria-hidden="true" tabindex="-1"></a>krvne_skupine <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;O&quot;</span>, <span class="st">&quot;AB&quot;</span>, <span class="st">&quot;BA&quot;</span>)</span></code></pre></div>
<p>Sedaj je ta vektor shranjen kot niz. Kaj so slabosti takšnega shranjevanja kategoričnih podatkov? Prvič, nimamo nobenega varovala pred tipkarskimi napakami – R je zadnji vnos prebral kot <em>BA</em> in ga tako tudi shranil, čeprav ta krvna skupina ne obstaja:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb146-1" aria-hidden="true" tabindex="-1"></a>krvne_skupine</span></code></pre></div>
<pre><code>## [1] &quot;B&quot;  &quot;B&quot;  &quot;O&quot;  &quot;AB&quot; &quot;BA&quot;</code></pre>
<p>Pri ročnem vnosu podatkov hitro pride do tipkarskih napak in načeloma ne vemo, ali je avtor podatkov v tem primeru želel vnesti A, B ali AB.</p>
<p>Drugič, če želimo urediti to spremenljivko, se bodo vrednosti razvrstile po abecedi:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(krvne_skupine)</span></code></pre></div>
<pre><code>## [1] &quot;AB&quot; &quot;B&quot;  &quot;B&quot;  &quot;BA&quot; &quot;O&quot;</code></pre>
<p>Morda pa bi bilo bolj smiselno urediti po standardni ureditvi, torej A, B, AB, O.</p>
<p>Da se izognemo tem težavam, je bolje, če spremenljivko, za katero vemo, da bo zasedla eno od vnaprej določenih vrednosti, shranimo kot faktor. V R za to uporabimo funkcijo <code>factor()</code>. Naredimo faktor iz spremenljivke <code>krvne_skupine</code>:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb150-1" aria-hidden="true" tabindex="-1"></a>krvne_skupine_fac <span class="ot">&lt;-</span> <span class="fu">factor</span>(krvne_skupine)</span>
<span id="cb150-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb150-2" aria-hidden="true" tabindex="-1"></a>krvne_skupine_fac</span></code></pre></div>
<pre><code>## [1] B  B  O  AB BA
## Levels: AB B BA O</code></pre>
<p>Opazimo, da je sedaj spremenljivka drugačnega tipa, saj hrani tudi informacijo o možnih vrednostih oziroma ravneh (ang. levels). Ampak v tem primeru so te ravni napačne (ne zajame vseh 4 krvnih skupin, poleg tega pa vsebuje tudi eno napačno vrednost). Funkcija <code>factor()</code> privzeto kot ravni nastavi vse vrednosti v podani spremenljivki. Če želimo, ji lahko podamo dodaten argument <code>levels</code>, kjer ročno določimo, katere ravni bodo v spremenljivki. V kolikor to vemo vnaprej, je dobra praksa, da podamo tudi ta argument:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb152-1" aria-hidden="true" tabindex="-1"></a>krvne_skupine_fac <span class="ot">&lt;-</span> <span class="fu">factor</span>(krvne_skupine, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;AB&quot;</span>, <span class="st">&quot;O&quot;</span>))</span>
<span id="cb152-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb152-2" aria-hidden="true" tabindex="-1"></a>krvne_skupine_fac</span></code></pre></div>
<pre><code>## [1] B    B    O    AB   &lt;NA&gt;
## Levels: A B AB O</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(krvne_skupine_fac)</span></code></pre></div>
<pre><code>## [1] B  B  AB O 
## Levels: A B AB O</code></pre>
<p>Opazimo dvoje: sedaj lahko spremenljivko uredimo glede na standardno notacijo in nesmiselne vrednosti se spremenijo v <code>NA</code>. Faktorju torej ne moremo prirediti vrednosti, ki ni enaka eni izmed vrednosti v ravneh. Da dostopamo do vseh ravni faktorja, uporabimo funkcijo <code>levels()</code>:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(krvne_skupine_fac)</span></code></pre></div>
<pre><code>## [1] &quot;A&quot;  &quot;B&quot;  &quot;AB&quot; &quot;O&quot;</code></pre>
<p>Včasih imajo kategorične spremenljivke tudi smiselno razvrstitev po velikosti, ki pa se običajno ne da numerično izmeriti. Kot primer si poglejmo šolski uspeh, ki lahko zavzame 5 vrednosti. V kolikor želimo, da faktor hrani tudi informacijo o tem, da obstaja smiselna razvrstitev po velikosti, dodamo argument <code>ordered = TRUE</code>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb158-1" aria-hidden="true" tabindex="-1"></a>uspeh <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;odlično&quot;</span>, <span class="st">&quot;dobro&quot;</span>, <span class="st">&quot;dobro&quot;</span>, <span class="st">&quot;prav dobro&quot;</span>),</span>
<span id="cb158-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb158-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;nezadostno&quot;</span>, <span class="st">&quot;zadostno&quot;</span>, <span class="st">&quot;dobro&quot;</span>, <span class="st">&quot;prav dobro&quot;</span>, <span class="st">&quot;odlično&quot;</span>),</span>
<span id="cb158-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb158-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb158-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb158-4" aria-hidden="true" tabindex="-1"></a>uspeh</span></code></pre></div>
<pre><code>## [1] odlično    dobro      dobro      prav dobro
## Levels: nezadostno &lt; zadostno &lt; dobro &lt; prav dobro &lt; odlično</code></pre>
<p>Opazimo, da imamo sedaj pri izpisu nivojev dodatno informacijo o razvrstitvi uspeha. V praksi nam to omogoča primerjavo, medtem ko tega pri faktorjih, ki nimajo razvrstitve po velikosti, ne moremo narediti.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb160-1" aria-hidden="true" tabindex="-1"></a>uspeh[<span class="dv">2</span>] <span class="sc">&gt;</span> uspeh[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb162-1" aria-hidden="true" tabindex="-1"></a>krvne_skupine_fac[<span class="dv">2</span>] <span class="sc">&gt;</span> krvne_skupine_fac[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## Warning in Ops.factor(krvne_skupine_fac[2], krvne_skupine_fac[1]): &#39;&gt;&#39; not
## meaningful for factors</code></pre>
<pre><code>## [1] NA</code></pre>
<p>Poleg prednosti, ki smo jih že omenili, imajo faktorji posebno vlogo pri raznih statističnih modelih in modelih strojnega učenja. Nekatere metode eksplicitno zahtevajo faktorje. Prav tako razlikujejo med nominalnimi in ordinalnimi faktorji, kar se pozna na rezultatih. Ravno tako so faktorji pomembni v primeru, ko poznamo nabor možnih vrednosti a nekaterih pri meritvah še nismo opazili. Pri izrisu želimo take vrednosti izpisati z vrednostjo 0 ali NA.</p>
<p>Poglejmo si uporabo faktorjev na realni podatkovni množici. Ponovno bomo delali s podatki o zaposlitvah na področju podatkovnih ved. Preberimo podatke in ponovimo nekaj operacij, ki smo jih spoznali na prvem predavanju. Prav tako bomo izbrali samo podmnožico stolpcev za bolj jasen prikaz.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb165-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb165-2" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">&quot;./data-raw/DS-jobs.csv&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Age, EmploymentStatus,</span>
<span id="cb165-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb165-4" aria-hidden="true" tabindex="-1"></a>         FormalEducation, CompensationAmount, ExchangeRate) <span class="sc">%&gt;%</span></span>
<span id="cb165-5"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ExchangeRate)) <span class="sc">%&gt;%</span></span>
<span id="cb165-6"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CompensationUSD =</span> CompensationAmount <span class="sc">*</span> ExchangeRate) <span class="sc">%&gt;%</span></span>
<span id="cb165-7"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CompensationUSD <span class="sc">&lt;=</span> <span class="dv">2500000</span>, CompensationUSD <span class="sc">&gt;=</span> <span class="dv">10000</span>)</span>
<span id="cb165-8"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb165-8" aria-hidden="true" tabindex="-1"></a>ds_jobs</span></code></pre></div>
<pre><code>## # A tibble: 3,186 x 7
##    Country    Age EmploymentStatus FormalEducation CompensationAmo~ ExchangeRate
##    &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;                      &lt;dbl&gt;        &lt;dbl&gt;
##  1 Austral~    43 Employed full-t~ Bachelor&#39;s deg~            80000     0.802   
##  2 Russia      33 Employed full-t~ Bachelor&#39;s deg~          1200000     0.0174  
##  3 Taiwan      26 Employed full-t~ Master&#39;s degree          1100000     0.0333  
##  4 United ~    25 Employed part-t~ Bachelor&#39;s deg~            20000     1       
##  5 United ~    33 Employed full-t~ Doctoral degree           100000     1       
##  6 Russia      22 Employed full-t~ Bachelor&#39;s deg~           624000     0.0174  
##  7 Colombia    34 Employed full-t~ Master&#39;s degree        156000000     0.000342
##  8 Germany     41 Independent con~ I did not comp~           150000     1.20    
##  9 Poland      29 Employed full-t~ Master&#39;s degree           126000     0.281   
## 10 United ~    35 Employed full-t~ Doctoral degree           133000     1       
## # ... with 3,176 more rows, and 1 more variable: CompensationUSD &lt;dbl&gt;</code></pre>
<p>Imamo 3 spremenljivke, ki bi jih bilo smiselno shraniti kot faktorje – <code>Country</code>, <code>EmploymentStatus</code> in <code>FormalEducation</code>. Pretvorimo jih v faktorje. Pri tem pustimo kar privzeto nastavitev, da se kot nivoji uporabijo vse vrednosti v stolpcih.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb167-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb167-2" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="ot">&lt;-</span> ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Country          =</span> <span class="fu">factor</span>(Country),</span>
<span id="cb167-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb167-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">EmploymentStatus =</span> <span class="fu">factor</span>(EmploymentStatus),</span>
<span id="cb167-5"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb167-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">FormalEducation  =</span> <span class="fu">factor</span>(FormalEducation))</span>
<span id="cb167-6"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb167-6" aria-hidden="true" tabindex="-1"></a>ds_jobs</span></code></pre></div>
<pre><code>## # A tibble: 3,186 x 7
##    Country    Age EmploymentStatus FormalEducation CompensationAmo~ ExchangeRate
##    &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;            &lt;fct&gt;                      &lt;dbl&gt;        &lt;dbl&gt;
##  1 Austral~    43 Employed full-t~ Bachelor&#39;s deg~            80000     0.802   
##  2 Russia      33 Employed full-t~ Bachelor&#39;s deg~          1200000     0.0174  
##  3 Taiwan      26 Employed full-t~ Master&#39;s degree          1100000     0.0333  
##  4 United ~    25 Employed part-t~ Bachelor&#39;s deg~            20000     1       
##  5 United ~    33 Employed full-t~ Doctoral degree           100000     1       
##  6 Russia      22 Employed full-t~ Bachelor&#39;s deg~           624000     0.0174  
##  7 Colombia    34 Employed full-t~ Master&#39;s degree        156000000     0.000342
##  8 Germany     41 Independent con~ I did not comp~           150000     1.20    
##  9 Poland      29 Employed full-t~ Master&#39;s degree           126000     0.281   
## 10 United ~    35 Employed full-t~ Doctoral degree           133000     1       
## # ... with 3,176 more rows, and 1 more variable: CompensationUSD &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(ds_jobs<span class="sc">$</span>Country)</span></code></pre></div>
<pre><code>##  [1] &quot;Argentina&quot;                   &quot;Australia&quot;                  
##  [3] &quot;Belarus&quot;                     &quot;Belgium&quot;                    
##  [5] &quot;Brazil&quot;                      &quot;Canada&quot;                     
##  [7] &quot;Chile&quot;                       &quot;Colombia&quot;                   
##  [9] &quot;Czech Republic&quot;              &quot;Denmark&quot;                    
## [11] &quot;Egypt&quot;                       &quot;Finland&quot;                    
## [13] &quot;France&quot;                      &quot;Germany&quot;                    
## [15] &quot;Greece&quot;                      &quot;Hong Kong&quot;                  
## [17] &quot;Hungary&quot;                     &quot;India&quot;                      
## [19] &quot;Indonesia&quot;                   &quot;Iran&quot;                       
## [21] &quot;Ireland&quot;                     &quot;Israel&quot;                     
## [23] &quot;Italy&quot;                       &quot;Japan&quot;                      
## [25] &quot;Kenya&quot;                       &quot;Malaysia&quot;                   
## [27] &quot;Mexico&quot;                      &quot;Netherlands&quot;                
## [29] &quot;New Zealand&quot;                 &quot;Nigeria&quot;                    
## [31] &quot;Norway&quot;                      &quot;Other&quot;                      
## [33] &quot;Pakistan&quot;                    &quot;People &#39;s Republic of China&quot;
## [35] &quot;Philippines&quot;                 &quot;Poland&quot;                     
## [37] &quot;Portugal&quot;                    &quot;Republic of China&quot;          
## [39] &quot;Romania&quot;                     &quot;Russia&quot;                     
## [41] &quot;Singapore&quot;                   &quot;South Africa&quot;               
## [43] &quot;South Korea&quot;                 &quot;Spain&quot;                      
## [45] &quot;Sweden&quot;                      &quot;Switzerland&quot;                
## [47] &quot;Taiwan&quot;                      &quot;Turkey&quot;                     
## [49] &quot;Ukraine&quot;                     &quot;United Kingdom&quot;             
## [51] &quot;United States&quot;               &quot;Vietnam&quot;</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(ds_jobs<span class="sc">$</span>EmploymentStatus)</span></code></pre></div>
<pre><code>## [1] &quot;Employed full-time&quot;                                  
## [2] &quot;Employed part-time&quot;                                  
## [3] &quot;Independent contractor, freelancer, or self-employed&quot;</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(ds_jobs<span class="sc">$</span>FormalEducation)</span></code></pre></div>
<pre><code>## [1] &quot;Bachelor&#39;s degree&quot;                                                
## [2] &quot;Doctoral degree&quot;                                                  
## [3] &quot;I did not complete any formal education past high school&quot;         
## [4] &quot;I prefer not to answer&quot;                                           
## [5] &quot;Master&#39;s degree&quot;                                                  
## [6] &quot;Professional degree&quot;                                              
## [7] &quot;Some college/university study without earning a bachelor&#39;s degree&quot;</code></pre>
<p>Kaj se zgodi, če želimo v tibblu spremeniti vrednost faktorja v neko vrednost, ki je ni v tem faktorju? Recimo, da želimo v 2. vrstici spremeniti državo v Narnia:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb175-1" aria-hidden="true" tabindex="-1"></a>ds_jobs2 <span class="ot">&lt;-</span> ds_jobs</span>
<span id="cb175-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb175-2" aria-hidden="true" tabindex="-1"></a>ds_jobs2<span class="sc">$</span>Country[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Narnia&quot;</span></span></code></pre></div>
<pre><code>## Warning in `[&lt;-.factor`(`*tmp*`, 2, value = structure(c(2L, NA, 47L, 51L, :
## invalid factor level, NA generated</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb177-1" aria-hidden="true" tabindex="-1"></a>ds_jobs2</span></code></pre></div>
<pre><code>## # A tibble: 3,186 x 7
##    Country    Age EmploymentStatus FormalEducation CompensationAmo~ ExchangeRate
##    &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;            &lt;fct&gt;                      &lt;dbl&gt;        &lt;dbl&gt;
##  1 Austral~    43 Employed full-t~ Bachelor&#39;s deg~            80000     0.802   
##  2 &lt;NA&gt;        33 Employed full-t~ Bachelor&#39;s deg~          1200000     0.0174  
##  3 Taiwan      26 Employed full-t~ Master&#39;s degree          1100000     0.0333  
##  4 United ~    25 Employed part-t~ Bachelor&#39;s deg~            20000     1       
##  5 United ~    33 Employed full-t~ Doctoral degree           100000     1       
##  6 Russia      22 Employed full-t~ Bachelor&#39;s deg~           624000     0.0174  
##  7 Colombia    34 Employed full-t~ Master&#39;s degree        156000000     0.000342
##  8 Germany     41 Independent con~ I did not comp~           150000     1.20    
##  9 Poland      29 Employed full-t~ Master&#39;s degree           126000     0.281   
## 10 United ~    35 Employed full-t~ Doctoral degree           133000     1       
## # ... with 3,176 more rows, and 1 more variable: CompensationUSD &lt;dbl&gt;</code></pre>
<p>Ker Narnia ni nivo v faktorju, se nadomesti z <code>NA</code>. Če želimo dodati nov nivo temu faktorju, uporabimo <code>fct_expand()</code>:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb179-1" aria-hidden="true" tabindex="-1"></a>ds_jobs2 <span class="ot">&lt;-</span> ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Country =</span> <span class="fu">fct_expand</span>(Country, <span class="st">&quot;Narnia&quot;</span>))</span>
<span id="cb179-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb179-3" aria-hidden="true" tabindex="-1"></a>ds_jobs2<span class="sc">$</span>Country[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;Narnia&quot;</span></span>
<span id="cb179-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb179-4" aria-hidden="true" tabindex="-1"></a>ds_jobs2</span></code></pre></div>
<pre><code>## # A tibble: 3,186 x 7
##    Country    Age EmploymentStatus FormalEducation CompensationAmo~ ExchangeRate
##    &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;            &lt;fct&gt;                      &lt;dbl&gt;        &lt;dbl&gt;
##  1 Austral~    43 Employed full-t~ Bachelor&#39;s deg~            80000     0.802   
##  2 Narnia      33 Employed full-t~ Bachelor&#39;s deg~          1200000     0.0174  
##  3 Taiwan      26 Employed full-t~ Master&#39;s degree          1100000     0.0333  
##  4 United ~    25 Employed part-t~ Bachelor&#39;s deg~            20000     1       
##  5 United ~    33 Employed full-t~ Doctoral degree           100000     1       
##  6 Russia      22 Employed full-t~ Bachelor&#39;s deg~           624000     0.0174  
##  7 Colombia    34 Employed full-t~ Master&#39;s degree        156000000     0.000342
##  8 Germany     41 Independent con~ I did not comp~           150000     1.20    
##  9 Poland      29 Employed full-t~ Master&#39;s degree           126000     0.281   
## 10 United ~    35 Employed full-t~ Doctoral degree           133000     1       
## # ... with 3,176 more rows, and 1 more variable: CompensationUSD &lt;dbl&gt;</code></pre>
<div id="sprememba-razvrstitve-faktorja" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Sprememba razvrstitve faktorja</h3>
<p>Kot smo omenili že pri krvnih skupinah, imajo velikokrat tudi faktorji, ki niso razvrščeni po velikosti, neko ustaljeno ureditev. Ureditev pa lahko tudi kasneje spremenimo. Ta operacija je običajno uporabna pri vizualizaciji. Poglejmo si, na primer, kako so plače povezane z izobrazbo. Za vizualizacijo rezultatov bomo uporabili razsevni diagram:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb181-1" aria-hidden="true" tabindex="-1"></a>ds_jobs_agg <span class="ot">&lt;-</span> ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb181-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(FormalEducation) <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanCompensationUSD =</span> <span class="fu">mean</span>(CompensationUSD))</span>
<span id="cb181-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb181-4" aria-hidden="true" tabindex="-1"></a>ds_jobs_agg</span></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   FormalEducation                                             MeanCompensationU~
##   &lt;fct&gt;                                                                    &lt;dbl&gt;
## 1 Bachelor&#39;s degree                                                       71665.
## 2 Doctoral degree                                                         90856.
## 3 I did not complete any formal education past high school                78470.
## 4 I prefer not to answer                                                  90023.
## 5 Master&#39;s degree                                                         78411.
## 6 Professional degree                                                     64614.
## 7 Some college/university study without earning a bachelor&#39;s~            105675.
## 8 &lt;NA&gt;                                                                    47833.</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds_jobs_agg, <span class="fu">aes</span>(<span class="at">x =</span> FormalEducation, <span class="at">y =</span> MeanCompensationUSD)) <span class="sc">+</span></span>
<span id="cb183-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb183-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb183-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-72-1.png" width="768" /></p>
<p>Ta graf je sicer zelo informativen, ampak bi s težavo hitro ugotovili, kako so nivoji faktorja razvrščeni glede na plačo. ggplot razvrsti vrednosti glede na to, kako so razvrščene v faktorju:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(ds_jobs<span class="sc">$</span>FormalEducation)</span></code></pre></div>
<pre><code>## [1] &quot;Bachelor&#39;s degree&quot;                                                
## [2] &quot;Doctoral degree&quot;                                                  
## [3] &quot;I did not complete any formal education past high school&quot;         
## [4] &quot;I prefer not to answer&quot;                                           
## [5] &quot;Master&#39;s degree&quot;                                                  
## [6] &quot;Professional degree&quot;                                              
## [7] &quot;Some college/university study without earning a bachelor&#39;s degree&quot;</code></pre>
<p>Morda bi bilo bolje tak graf urediti glede na vrednosti spremenljivke <code>MeanCompensationUSD</code>, za kar moramo določiti novo razvrstitev te spremenljivke. Za to obstaja v paketu <strong>forcats</strong>, ki je del tidyverse, funkcija <code>fct_reorder()</code>.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds_jobs_agg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(FormalEducation, MeanCompensationUSD), <span class="at">y =</span> MeanCompensationUSD)) <span class="sc">+</span></span>
<span id="cb186-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb186-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb186-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-74-1.png" width="768" /></p>
<p>Razvrstitev lahko uredimo tudi ročno s funkcijo <code>fct_relevel()</code>, ki ohrani privzeto razvrstitev tako, da podane nivoje premakne na začetek, oziroma lahko podamo argument <code>after</code>.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds_jobs_agg, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_relevel</span>(FormalEducation, <span class="st">&quot;I prefer not to answer&quot;</span>, <span class="st">&quot;I did not complete any formal education past high school&quot;</span>, <span class="at">after =</span> <span class="dv">0</span>), <span class="at">y =</span> MeanCompensationUSD)) <span class="sc">+</span></span>
<span id="cb187-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb187-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb187-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-75-1.png" width="768" /></p>
</div>
<div id="preimenivanje-obstoječih-nivojev" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Preimenivanje obstoječih nivojev</h3>
<p>Nivoje faktorjev lahko preimenujemo s funkcijo <code>fct_recode()</code>.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb188-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="ot">&lt;-</span> ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb188-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EmploymentStatus =</span> <span class="fu">fct_recode</span>(EmploymentStatus,</span>
<span id="cb188-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb188-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;full-time&quot;</span> <span class="ot">=</span> <span class="st">&quot;Employed full-time&quot;</span>,</span>
<span id="cb188-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb188-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;part-time&quot;</span> <span class="ot">=</span> <span class="st">&quot;Employed part-time&quot;</span>,</span>
<span id="cb188-5"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb188-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">&quot;other&quot;</span> <span class="ot">=</span> <span class="st">&quot;Independent contractor, freelancer, or self-employed&quot;</span>))</span>
<span id="cb188-6"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ds_jobs<span class="sc">$</span>EmploymentStatus)</span></code></pre></div>
<pre><code>## [1] full-time full-time full-time part-time full-time full-time
## Levels: full-time part-time other</code></pre>
<p>Sorodno lahko zgornjo funkcijo zamenjamo s <code>fct_collapse()</code>, ki lahko združi več nivojev v enega.</p>
</div>
<div id="razbitje-numerične-spremenljivke-na-intervale" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Razbitje numerične spremenljivke na intervale</h3>
<p>Pogosto želimo numerično spremenljivko segmentirati na določene intervale. Na primer, pri določanju avtomobilskih zavarovalnih premij lahko zavarovance segmentiramo glede na starost. V R za to uporabimo funkcijo <code>cut()</code>. Razdelimo spremenljivko <code>Age</code> na intervale, kjer bodo osebe razdeljene do 25 let, nad 25 in to 35 let, nad 35 do 50 let, in nad 50 let.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb190-1" aria-hidden="true" tabindex="-1"></a>ds_jobs <span class="ot">&lt;-</span> ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb190-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AgeInterval =</span> <span class="fu">cut</span>(Age, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">50</span>, <span class="dv">100</span>)))</span>
<span id="cb190-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb190-3" aria-hidden="true" tabindex="-1"></a>ds_jobs_agg <span class="ot">&lt;-</span> ds_jobs <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(AgeInterval) <span class="sc">%&gt;%</span></span>
<span id="cb190-5"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">CompensationByAge =</span> <span class="fu">mean</span>(CompensationUSD))</span>
<span id="cb190-6"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ds_jobs_agg, <span class="fu">aes</span>(<span class="at">x =</span> AgeInterval, <span class="at">y =</span> CompensationByAge)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
</div>
<div id="datumi-in-ure" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Datumi in ure</h2>
<p>Delo z datumi in urami na prvi pogled morda deluje enostavno. Vendar pa zaradi različnih fizikalnih zakonitosti ali človeških konstruktov lahko pride do težav. Na primer, vsako leto nima 365 dni. Prav tako v nekaterih časovnih conah 3. ura zjutraj ne sledi vedno 2. uri, saj pride do premika ure.</p>
<p>Za delo z datumi bomo uporabljali paket <strong>lubridate</strong>. Glavni komponenti v tem paketu sta <strong>datum</strong> (date) in <strong>čas</strong> (time) ter združena komponenta <strong>datum in čas</strong> (datetime). S tem paketom lahko datume ustvarimo na 2 načina:</p>
<ol style="list-style-type: decimal">
<li><p>Z nizom:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb191-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">&quot;2021-04-02&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02&quot;</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="st">&quot;2021/04/02&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02&quot;</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="dv">20210402</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02&quot;</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dmy</span>(<span class="st">&quot;02.04.2021&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02&quot;</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hms</span>(<span class="st">&quot;2021-04-02 12:01:00&quot;</span>) <span class="co"># Tipa datetime.</span></span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02 12:01:00 UTC&quot;</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd</span>(<span class="dv">20210402</span>, <span class="dv">20210403</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02&quot; &quot;2021-04-03&quot;</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mdy</span>(<span class="st">&quot;April 2nd, 2021&quot;</span>) <span class="co"># Deluje za angleška imena mesecev.</span></span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02&quot;</code></pre></li>
<li><p>S posameznimi komponentami:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_date</span>(<span class="dv">2021</span>, <span class="dv">4</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02&quot;</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_datetime</span>(<span class="dv">2021</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02 12:01:00 UTC&quot;</code></pre></li>
</ol>
<p>Opazimo, da pri datumu in času spremenljivka hrani tudi informacijo o časovnem pasu. Privzeto lubridate dela s časovnim pasom UTC (Coordinated Universal Time), ki je naslednik GMT (Greenwich Mean Time). Prednost tega časovnega pasu je , da se ne prilagaja spremembi ure v pomladnih in jesenskih mesecih. Te spremembe lahko privedejo do napak pri računanju z datumi in časi, tako da je računanje v UTC bolj varno. Seveda pa lahko ročno nastavimo drugi časovni pas z argumentom <code>tz</code>. Paket lubridate uporablja IANA časovne pasove (<a href="https://www.iana.org/time-zones" class="uri">https://www.iana.org/time-zones</a>), ki so definirani s kombinacijo celine in države. Za Ljubljano bi časovni pas nastavili tako:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hms</span>(<span class="st">&quot;2021-04-02 12:01:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Europe/Ljubljana&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02 12:01:00 CEST&quot;</code></pre>
<p>Pomembno je , da vemo, v katerem časovnem pasu so bile opravljene meritve v naših podatkih, da lahko potem ustrezno pretvorimo spremenljivko v časovno. Seveda pa lahko tudi pretvarjamo časovne spremenljivke med časovnimi pasovi. Za to uporabimo funkcijo <code>with_tz()</code>. Vsakemu času v določenem časovnem pasu lahko priredimo nek čas v drugem časovnem pasu. V kolikor želimo bolj robustno računati z datumi in urami, lahko vedno datume pretvorimo v UTC čas, naredimo izračune in potem pretvorimo nazaj v lokalni časovni pas.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb211-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">&quot;2021-04-02 12:01:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Europe/Ljubljana&quot;</span>)</span>
<span id="cb211-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb211-2" aria-hidden="true" tabindex="-1"></a>my_datetime</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02 12:01:00 CEST&quot;</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb213-1" aria-hidden="true" tabindex="-1"></a>my_datetime_UTC <span class="ot">&lt;-</span> <span class="fu">with_tz</span>(my_datetime, <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb213-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb213-2" aria-hidden="true" tabindex="-1"></a>my_datetime_UTC</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-02 10:01:00 UTC&quot;</code></pre>
<p>V ozdaju pa spremenljivki hranita isti čas. To lahko preverimo z:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb215-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">==</span> my_datetime_UTC</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>V R je časovni pas namenjen samo izpisu datumov in časov. Vrednost spremenljivke ostane nespremenjena. To lahko preverimo tako, da odštejemo en datum od drugega, kar nam vrne razliko v času:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb217-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">-</span> my_datetime_UTC</span></code></pre></div>
<pre><code>## Time difference of 0 secs</code></pre>
<p>V kolikor smo narobe prebrali datum v začetku (na primer, v podatkih je bil datum v UTC, prebrali pa smo v lokalnem času) zgornja pretvorba med časovnimi pasovi ni ustrezna, saj bomo s tem zajeli napačen čas. V tem primeru moramo uporabiti funkcijo <code>force_tz()</code>. Poizkusite kaj naredi ta funkcija, tako da z njo pretvorijo <code>my_datetime</code> v UTC in potem izračunajte razliko, podobno kot smo to naredili zgoraj.</p>
<p>Kadar delamo sekvence datumov in časov, te upoštevajo premik ure in prehodov v naslednje dni. Poglejmo si prehod na poletni čas v letu 2021:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb219-1" aria-hidden="true" tabindex="-1"></a>datetime_dst <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ymd_hms</span>(<span class="st">&quot;2021-03-28 00:00:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Europe/Ljubljana&quot;</span>),</span>
<span id="cb219-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb219-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ymd_hms</span>(<span class="st">&quot;2021-03-28 04:00:00&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Europe/Ljubljana&quot;</span>),</span>
<span id="cb219-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb219-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by =</span> <span class="st">&quot;30 min&quot;</span>)</span>
<span id="cb219-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb219-4" aria-hidden="true" tabindex="-1"></a>datetime_dst</span></code></pre></div>
<pre><code>## [1] &quot;2021-03-28 00:00:00 CET&quot;  &quot;2021-03-28 00:30:00 CET&quot; 
## [3] &quot;2021-03-28 01:00:00 CET&quot;  &quot;2021-03-28 01:30:00 CET&quot; 
## [5] &quot;2021-03-28 03:00:00 CEST&quot; &quot;2021-03-28 03:30:00 CEST&quot;
## [7] &quot;2021-03-28 04:00:00 CEST&quot;</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with_tz</span>(datetime_dst, <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-03-27 23:00:00 UTC&quot; &quot;2021-03-27 23:30:00 UTC&quot;
## [3] &quot;2021-03-28 00:00:00 UTC&quot; &quot;2021-03-28 00:30:00 UTC&quot;
## [5] &quot;2021-03-28 01:00:00 UTC&quot; &quot;2021-03-28 01:30:00 UTC&quot;
## [7] &quot;2021-03-28 02:00:00 UTC&quot;</code></pre>
<p>Pozorni moramo biti tudi na kombiniranje datumov. V kolikor uporabimo funkcijo <code>c()</code>, vedno preverimo, v katerem časovnem pasu je rezultat.</p>
<div id="računanje-z-datumi-in-časi" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Računanje z datumi in časi</h3>
<p>Vsaka časovna spremenljivka, ki vsebuje datum in čas, je sestavljena iz komponent. Te so leto, mesec, dan, ura, minuta in sekunda. Za dostop do posameznih komponent imamo na voljo več funkcij:</p>
<ul>
<li><code>year()</code></li>
<li><code>month()</code></li>
<li><code>mday()</code> Dan v mesecu.</li>
<li><code>wday()</code> Dan v tednu. Privzeto se začne z nedeljo. To lahko spremenimo z argumentom <code>week_start</code>.</li>
<li><code>hour()</code></li>
<li><code>minute()</code></li>
<li><code>second()</code></li>
</ul>
<p>Poglejmo sedaj kaj vračajo te funkcije:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb223-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">now</span>()</span>
<span id="cb223-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb223-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-15 08:50:51 CEST&quot;</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">year</span>(x)</span></code></pre></div>
<pre><code>## [1] 2021</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">month</span>(x)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mday</span>(x)</span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(x)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wday</span>(x, <span class="at">week_start =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hour</span>(x)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">minute</span>(x)</span></code></pre></div>
<pre><code>## [1] 50</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">second</span>(x)</span></code></pre></div>
<pre><code>## [1] 51.57082</code></pre>
<p>S komponentami lahko tudi spreminjamo dele časovne spremenljivke:</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mday</span>(x) <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb241-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb241-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-05 08:50:51 CEST&quot;</code></pre>
<p>Pri računanju s časovnimi enotami v lubridate poznamo tri razrede:</p>
<ul>
<li><strong>trajanja</strong> (ang. duration). Čas v sekundah. Funkcije <code>dseconds()</code>, <code>dminutes()</code>, <code>ddays()</code>, <code>dweeks()</code> in <code>dyears()</code>. Pri trajanjih se vedno uporabi pretvorba, da ima vsak dan 24 ur in vsako leto 365.25 dni. Slednje predstavlja povprečno šteilo dni v letu. Tako da bo funkcija <code>dyears(4)</code> vedno vrnila število sekund, ki ustreza 4x365.25 dnem, ki imajo vsak po 24 ur.</li>
<li><strong>obdobja</strong> (ang. period). Čas v človeških enotah kot je na primer teden. Funkcije <code>seconds()</code>, <code>minutes()</code>, <code>days()</code>, <code>weeks()</code>, <code>months()</code> in <code>years()</code>.</li>
<li><strong>intervali</strong> (ang. interval). Časovni interval med dvema točkama.</li>
</ul>
<p>Pozoren bralec je opazil, da pri trajanjih nismo navedli funkcije za mesece. To pa zato, ker imajo meseci lahko 28, 29, 30 ali 31 dni. Vsekakor bi pri izbiri osnovne enote za trajanja prišlo do neke arbitrarne odločitve, koliko dni vzamemo privzeto. 30 ali 31? V vsakem primeru bo vsaj polovica mesecev imela napačno trajanje. Pri dnevih in letih si lažje privoščimo posplošitev.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ddays</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;86400s (~1 days)&quot;</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">days</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1d 0H 0M 0S&quot;</code></pre>
<p>Poglejmo si preprost primer, kako dodati določena obdobja:</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb247-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">&quot;2021/06/08 11:05:30&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Europe/Ljubljana&quot;</span>)</span>
<span id="cb247-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb247-2" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-09 11:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb249-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-09 11:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb251-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">dminutes</span>(<span class="dv">120</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-08 13:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb253-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">minutes</span>(<span class="dv">120</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-08 13:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb255-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-08-08 11:05:30 CEST&quot;</code></pre>
<p>Trajanja in obdobja so si očitno zelo podobni, ampak imajo eno veliko razliko, kadar računamo z dnevi, tedni in leti. Prvič, kadar bomo uporabljali <code>dyears()</code> lahko hitro pride do težave, saj bomo prišteli 0.25 dneva. Poglejmo si to na primeru:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb257-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-06-08 11:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb259-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">dyears</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2022-06-08 17:05:30 CEST&quot;</code></pre>
<p>Opazimo, da smo prišteli 6 dodatnih ur. Drugič, kaj se zgodi, kadar prištejemo teden ali dan v času, ko pride do premika ure. Premik ure se je po lokalnem času zgodil 28. 3. 2021 ob 2 zjutraj.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb261-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">&quot;2021/03/27 11:05:30&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Europe/Ljubljana&quot;</span>)</span>
<span id="cb261-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb261-2" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-03-28 12:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb263-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">days</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-03-28 11:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb265-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">dweeks</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-03 12:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb267-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">weeks</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-04-03 11:05:30 CEST&quot;</code></pre>
<p>Funkcija <code>years()</code> deluje, kot bi pričakovali tudi na prestopnem letu:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb269-1" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(<span class="st">&quot;2020/06/08 11:05:30&quot;</span>, <span class="at">tz =</span> <span class="st">&quot;Europe/Ljubljana&quot;</span>)</span>
<span id="cb269-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb269-2" aria-hidden="true" tabindex="-1"></a>my_datetime <span class="sc">+</span> <span class="fu">years</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2021-06-08 11:05:30 CEST&quot;</code></pre>
<p>S funkcijami trajanja in obdobji lahko tudi računamo, na primer:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dyears</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">ddays</span>(<span class="dv">4</span>) <span class="sc">+</span> <span class="fu">dseconds</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] &quot;63460820s (~2.01 years)&quot;</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">days</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">minutes</span>(<span class="dv">20</span>) <span class="sc">+</span> <span class="fu">seconds</span>(<span class="dv">120</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2d 0H 20M 120S&quot;</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">*</span> <span class="fu">dminutes</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] &quot;6000s (~1.67 hours)&quot;</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">*</span> <span class="fu">minutes</span>(<span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] &quot;100M 0S&quot;</code></pre>
<p>V bazi letalskih letov posodobimo podatke tako, da izračunamo niz, ki predstavlja odhod letala.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb279-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flights)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 19
##    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
## 1  2013     1     1      517            515         2      830            819
## 2  2013     1     1      533            529         4      850            830
## 3  2013     1     1      542            540         2      923            850
## 4  2013     1     1      544            545        -1     1004           1022
## 5  2013     1     1      554            600        -6      812            837
## 6  2013     1     1      554            558        -4      740            728
## # ... with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb281-1" aria-hidden="true" tabindex="-1"></a>flights_datetime <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(year, month, day, hour, minute) <span class="sc">%&gt;%</span></span>
<span id="cb281-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb281-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DepartureTime =</span> <span class="fu">make_datetime</span>(year, month, day, hour, minute))</span>
<span id="cb281-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb281-3" aria-hidden="true" tabindex="-1"></a>flights_datetime</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 6
##     year month   day  hour minute DepartureTime      
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;             
##  1  2013     1     1     5     15 2013-01-01 05:15:00
##  2  2013     1     1     5     29 2013-01-01 05:29:00
##  3  2013     1     1     5     40 2013-01-01 05:40:00
##  4  2013     1     1     5     45 2013-01-01 05:45:00
##  5  2013     1     1     6      0 2013-01-01 06:00:00
##  6  2013     1     1     5     58 2013-01-01 05:58:00
##  7  2013     1     1     6      0 2013-01-01 06:00:00
##  8  2013     1     1     6      0 2013-01-01 06:00:00
##  9  2013     1     1     6      0 2013-01-01 06:00:00
## 10  2013     1     1     6      0 2013-01-01 06:00:00
## # ... with 336,766 more rows</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flights_datetime<span class="sc">$</span>DepartureTime)</span></code></pre></div>
<pre><code>## [1] &quot;2013-01-01 05:15:00 UTC&quot; &quot;2013-01-01 05:29:00 UTC&quot;
## [3] &quot;2013-01-01 05:40:00 UTC&quot; &quot;2013-01-01 05:45:00 UTC&quot;
## [5] &quot;2013-01-01 06:00:00 UTC&quot; &quot;2013-01-01 05:58:00 UTC&quot;</code></pre>
<p>Ali opazimo kakšno težavo? Datume smo prebrali v časovni coni UTC, podani pa so v lokalni časovni coni. Podatkov torej nismo pravilno pretvorili! Poizkusimo še enkrat:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb285-1" aria-hidden="true" tabindex="-1"></a>flights_datetime <span class="ot">&lt;-</span> flights <span class="sc">%&gt;%</span> <span class="fu">select</span>(year, month, day, hour, minute) <span class="sc">%&gt;%</span></span>
<span id="cb285-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DepartureTime =</span> <span class="fu">make_datetime</span>(year, month, day, hour, minute,</span>
<span id="cb285-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb285-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">tz =</span> <span class="st">&quot;America/New_York&quot;</span>))</span>
<span id="cb285-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb285-4" aria-hidden="true" tabindex="-1"></a>flights_datetime</span></code></pre></div>
<pre><code>## # A tibble: 336,776 x 6
##     year month   day  hour minute DepartureTime      
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;             
##  1  2013     1     1     5     15 2013-01-01 05:15:00
##  2  2013     1     1     5     29 2013-01-01 05:29:00
##  3  2013     1     1     5     40 2013-01-01 05:40:00
##  4  2013     1     1     5     45 2013-01-01 05:45:00
##  5  2013     1     1     6      0 2013-01-01 06:00:00
##  6  2013     1     1     5     58 2013-01-01 05:58:00
##  7  2013     1     1     6      0 2013-01-01 06:00:00
##  8  2013     1     1     6      0 2013-01-01 06:00:00
##  9  2013     1     1     6      0 2013-01-01 06:00:00
## 10  2013     1     1     6      0 2013-01-01 06:00:00
## # ... with 336,766 more rows</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(flights_datetime<span class="sc">$</span>DepartureTime)</span></code></pre></div>
<pre><code>## [1] &quot;2013-01-01 05:15:00 EST&quot; &quot;2013-01-01 05:29:00 EST&quot;
## [3] &quot;2013-01-01 05:40:00 EST&quot; &quot;2013-01-01 05:45:00 EST&quot;
## [5] &quot;2013-01-01 06:00:00 EST&quot; &quot;2013-01-01 05:58:00 EST&quot;</code></pre>
</div>
</div>
<div id="shranjevanje-in-branje-podatkov" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Shranjevanje in branje podatkov</h2>
<div id="delo-z-binarnimi-datotekami" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Delo z binarnimi datotekami</h3>
<p>V programskem jeziku R lahko spremenljivke shranjujemo in beremo (v trenutno sejo R) kot binarne objekte. Prednost tega shranjevanja pred shranjevanjem v csv ali excelove razpredelnice je, da se ohranijo tudi meta informacije, kot so recimo nivoji pri faktorjih. Shranjujemo na dva prevladujoča načina:</p>
<ol style="list-style-type: decimal">
<li>S kombinacijo funkcij <code>save()</code> in <code>load()</code>.</li>
<li>S kombinacijo funkcij <code>saveRDS()</code> in <code>readRDS()</code>.</li>
</ol>
<p>Pomembna razlika med prvim in drugim pristopom je, da lahko s prvim shranimo več spremenljivk naenkrat, z drugim pa samo eno. Na prvi pogled bi torej pričakovali, da je prvi pristop boljši, oziroma bolj zaželen. Ampak ima eno pomembno slabost, zaradi katere predlagamo uporabo drugega pristopa.</p>
<p>Funkcija <code>save()</code> shrani spremenljivke v trenutni seji R v datoteko s končnico <em>rda</em> ali <em>RData</em>. To naredi tako, da shrani tako vrednost spremenljivke kot tudi ime spremenljivke. To pomeni, da ko bomo takšno datoteko prebrali v novo sejo R, bomo ustvarili spremenljivke z enakimi imeni, kot smo jih shranili. Pri tem pa lahko pride do težav. Recimo, da imamo v trenutni seji R že nek nabor spremenljivk nato pa želimo vanjo prenesti še neke druge spremenljivke, ki smo jih pred časom shranili s funkcijo <code>save()</code> v datoteko saved-data.rda. Kaj se bo zgodilo, če bo katera od spremenljivk v naši trenutni seji imela enako ime kot ena od spremenljivk shranjenih v saved-data.rda? R bo enostavno to spremenljivko prepisal s spremenljivko, ki se je nahajala v tej rda datoteki. Takšen postopek dela je lahko torej nevaren, saj lahko <em>nevede</em> izbrišemo obstoječe spremenljivke.</p>
<p>Predlagamo torej uporabo kombinacije funkcij <code>saveRDS()</code> in <code>readRDS()</code>. Funkcija <code>saveRDS()</code> shrani samo vrednost spremenljivke, ne pa tudi njenega imena, tako da ne pride do podobnih težav kot pri prvem pristopu. Končnica tako shranjenih datotek je <em>rds</em>. Poglejmo si uporabo teh funkcij:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb289-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">7</span>)</span>
<span id="cb289-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb289-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 3 6 3 7</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(x, <span class="st">&quot;./my-saved-files/my-x.rds&quot;</span>)</span>
<span id="cb291-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb291-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb291-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;./my-saved-files/my-x.rds&quot;</span>)</span>
<span id="cb291-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb291-4" aria-hidden="true" tabindex="-1"></a>x2</span></code></pre></div>
<pre><code>## [1] 3 6 3 7</code></pre>
<p>Vedno ko preberemo podatke v sejo R s funkcijo <code>readRDS()</code>, ji moramo prirediti ime, saj je v rds datoteki shrnajena samo njena vrednost. S tem se tudi izognemo podobnim težavam kot pri funkcijah <code>save()</code> in <code>load()</code>.</p>
<p>Pomanjkljivost shranjevanja datotek rds je v tem, da lahko naenkrat shranimo samo 1 spremenljivko. Ampak to pomanjkljivost lahko zaobidemo tako, da več spremenljivk enostavno shranimov v seznam (<code>list()</code>). Poglejmo si sedaj na primer, kako bi shranili več spremenljivk.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-1" aria-hidden="true" tabindex="-1"></a>tmp_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb293-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x,</span>
<span id="cb293-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;some_datetime&quot;</span> <span class="ot">=</span> my_datetime,</span>
<span id="cb293-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;ds_jobs&quot;</span> <span class="ot">=</span> ds_jobs</span>
<span id="cb293-5"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb293-6"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-7"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(tmp_list, <span class="st">&quot;./my-saved-files/my-list.rds&quot;</span>)</span>
<span id="cb293-8"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-8" aria-hidden="true" tabindex="-1"></a>read_list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;./my-saved-files/my-list.rds&quot;</span>)</span>
<span id="cb293-9"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb293-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(read_list)</span></code></pre></div>
<pre><code>## [1] &quot;x&quot;             &quot;some_datetime&quot; &quot;ds_jobs&quot;</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb295-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> read_list[[<span class="st">&quot;x&quot;</span>]]</span>
<span id="cb295-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb295-2" aria-hidden="true" tabindex="-1"></a>x2</span></code></pre></div>
<pre><code>## [1] 3 6 3 7</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb297-1" aria-hidden="true" tabindex="-1"></a>my_datetime2 <span class="ot">&lt;-</span> read_list[[<span class="st">&quot;some_datetime&quot;</span>]]</span>
<span id="cb297-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb297-2" aria-hidden="true" tabindex="-1"></a>my_datetime2</span></code></pre></div>
<pre><code>## [1] &quot;2020-06-08 11:05:30 CEST&quot;</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb299-1" aria-hidden="true" tabindex="-1"></a>ds_jobs2 <span class="ot">&lt;-</span> read_list[[<span class="st">&quot;ds_jobs&quot;</span>]]</span>
<span id="cb299-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb299-2" aria-hidden="true" tabindex="-1"></a>ds_jobs2</span></code></pre></div>
<pre><code>## # A tibble: 3,186 x 8
##    Country    Age EmploymentStatus FormalEducation CompensationAmo~ ExchangeRate
##    &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt;            &lt;fct&gt;                      &lt;dbl&gt;        &lt;dbl&gt;
##  1 Austral~    43 full-time        Bachelor&#39;s deg~            80000     0.802   
##  2 Russia      33 full-time        Bachelor&#39;s deg~          1200000     0.0174  
##  3 Taiwan      26 full-time        Master&#39;s degree          1100000     0.0333  
##  4 United ~    25 part-time        Bachelor&#39;s deg~            20000     1       
##  5 United ~    33 full-time        Doctoral degree           100000     1       
##  6 Russia      22 full-time        Bachelor&#39;s deg~           624000     0.0174  
##  7 Colombia    34 full-time        Master&#39;s degree        156000000     0.000342
##  8 Germany     41 other            I did not comp~           150000     1.20    
##  9 Poland      29 full-time        Master&#39;s degree           126000     0.281   
## 10 United ~    35 full-time        Doctoral degree           133000     1       
## # ... with 3,176 more rows, and 2 more variables: CompensationUSD &lt;dbl&gt;,
## #   AgeInterval &lt;fct&gt;</code></pre>
</div>
<div id="branje-in-shranjevanje-z-ostalimi-datotekami" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Branje in shranjevanje z ostalimi datotekami</h3>
<div id="excel" class="section level4" number="3.5.2.1">
<h4><span class="header-section-number">3.5.2.1</span> Excel</h4>
<p>Paket <strong>openxlsx</strong> omogoča delo z exelovimi razpredelnicami. Poglejmo si preproste a uporabne ukaze. Za branje podatkov s tem paketom uprabljamo <code>read.xlsx()</code>, za shranjevanje datotek pa <code>write.xlsx()</code>.</p>
<p>Preberimo podatke ocen, ki smo jih imeli v testni skripti, in jo pretvorimo v tibble:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb301-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb301-2" aria-hidden="true" tabindex="-1"></a>ocene <span class="ot">&lt;-</span> <span class="fu">tibble</span>(openxlsx<span class="sc">::</span><span class="fu">read.xlsx</span>(<span class="st">&quot;./test-script/data-raw/student-performance.xlsx&quot;</span>))</span>
<span id="cb301-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb301-3" aria-hidden="true" tabindex="-1"></a>ocene</span></code></pre></div>
<pre><code>## # A tibble: 649 x 12
##    school sex   famsize Pstatus traveltime studytime internet absences    G1
##    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1 GP     F     GT3     A                2         2 no              4     0
##  2 GP     F     GT3     T                1         2 yes             2     9
##  3 GP     F     LE3     T                1         2 yes             6    12
##  4 GP     F     GT3     T                1         3 yes             0    14
##  5 GP     F     GT3     T                1         2 no              0    11
##  6 GP     M     LE3     T                1         2 yes             6    12
##  7 GP     M     LE3     T                1         2 yes             0    13
##  8 GP     F     GT3     A                2         2 no              2    10
##  9 GP     M     LE3     A                1         2 yes             0    15
## 10 GP     M     GT3     T                1         2 yes             0    12
## # ... with 639 more rows, and 3 more variables: G2 &lt;dbl&gt;, G3 &lt;dbl&gt;,
## #   averageScore &lt;dbl&gt;</code></pre>
<p>Privzeto funkcija <code>read.xlsx()</code> odpre prvi list v datoteki in poišče glavo razpredelnice. Če želimo druge liste moramo podati ime lista ali številko lista s parametrom <code>sheet</code>:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb303-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb303-2" aria-hidden="true" tabindex="-1"></a>ocene_portugalscina <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">read.xlsx</span>(<span class="st">&quot;./test-script/data-raw/student-performance.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>))</span>
<span id="cb303-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb303-3" aria-hidden="true" tabindex="-1"></a>ocene_matematika <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">read.xlsx</span>(<span class="st">&quot;./test-script/data-raw/student-performance.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Math scores&quot;</span>))</span>
<span id="cb303-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb303-4" aria-hidden="true" tabindex="-1"></a>ocene_portugalscina <span class="sc">%&gt;%</span></span>
<span id="cb303-5"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb303-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(school, G1, G2, G3, averageScore)</span></code></pre></div>
<pre><code>## # A tibble: 649 x 5
##    school    G1    G2    G3 averageScore
##    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
##  1 GP         0    11    11         7.33
##  2 GP         9    11    11        10.3 
##  3 GP        12    13    12        12.3 
##  4 GP        14    14    14        14   
##  5 GP        11    13    13        12.3 
##  6 GP        12    12    13        12.3 
##  7 GP        13    12    13        12.7 
##  8 GP        10    13    13        12   
##  9 GP        15    16    17        16   
## 10 GP        12    12    13        12.3 
## # ... with 639 more rows</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb305-1" aria-hidden="true" tabindex="-1"></a>ocene_matematika <span class="sc">%&gt;%</span></span>
<span id="cb305-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb305-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(school, G1, G2, G3, averageScore)</span></code></pre></div>
<pre><code>## # A tibble: 395 x 5
##    school    G1    G2    G3 averageScore
##    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
##  1 GP         5     6     6         5.67
##  2 GP         5     5     6         5.33
##  3 GP         7     8    10         8.33
##  4 GP        15    14    15        14.7 
##  5 GP         6    10    10         8.67
##  6 GP        15    15    15        15   
##  7 GP        12    12    11        11.7 
##  8 GP         6     5     6         5.67
##  9 GP        16    18    19        17.7 
## 10 GP        14    15    15        14.7 
## # ... with 385 more rows</code></pre>
<p>Če ima datoteka veliko število listov, jih lahko shranimo v R-jev list:</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb307-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb307-2" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;./test-script/data-raw/student-performance.xlsx&quot;</span></span>
<span id="cb307-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb307-3" aria-hidden="true" tabindex="-1"></a>imenaListov <span class="ot">&lt;-</span> <span class="fu">getSheetNames</span>(path)</span>
<span id="cb307-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb307-4" aria-hidden="true" tabindex="-1"></a>ocene_s <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb307-5"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb307-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(imenaListov)) {</span>
<span id="cb307-6"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb307-6" aria-hidden="true" tabindex="-1"></a>  ocene_s[[i]] <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">read.xlsx</span>(path))</span>
<span id="cb307-7"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb307-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb307-8"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb307-8" aria-hidden="true" tabindex="-1"></a>ocene_s</span></code></pre></div>
<pre><code>## [[1]]
## # A tibble: 649 x 12
##    school sex   famsize Pstatus traveltime studytime internet absences    G1
##    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1 GP     F     GT3     A                2         2 no              4     0
##  2 GP     F     GT3     T                1         2 yes             2     9
##  3 GP     F     LE3     T                1         2 yes             6    12
##  4 GP     F     GT3     T                1         3 yes             0    14
##  5 GP     F     GT3     T                1         2 no              0    11
##  6 GP     M     LE3     T                1         2 yes             6    12
##  7 GP     M     LE3     T                1         2 yes             0    13
##  8 GP     F     GT3     A                2         2 no              2    10
##  9 GP     M     LE3     A                1         2 yes             0    15
## 10 GP     M     GT3     T                1         2 yes             0    12
## # ... with 639 more rows, and 3 more variables: G2 &lt;dbl&gt;, G3 &lt;dbl&gt;,
## #   averageScore &lt;dbl&gt;
## 
## [[2]]
## # A tibble: 649 x 12
##    school sex   famsize Pstatus traveltime studytime internet absences    G1
##    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
##  1 GP     F     GT3     A                2         2 no              4     0
##  2 GP     F     GT3     T                1         2 yes             2     9
##  3 GP     F     LE3     T                1         2 yes             6    12
##  4 GP     F     GT3     T                1         3 yes             0    14
##  5 GP     F     GT3     T                1         2 no              0    11
##  6 GP     M     LE3     T                1         2 yes             6    12
##  7 GP     M     LE3     T                1         2 yes             0    13
##  8 GP     F     GT3     A                2         2 no              2    10
##  9 GP     M     LE3     A                1         2 yes             0    15
## 10 GP     M     GT3     T                1         2 yes             0    12
## # ... with 639 more rows, and 3 more variables: G2 &lt;dbl&gt;, G3 &lt;dbl&gt;,
## #   averageScore &lt;dbl&gt;</code></pre>
<p>V primeru, da je razpredelnica v excelovem listu premaknjena ali pa želimo prebrati le del podatkov, lahko uporabimo parametra <code>startRow</code> in <code>cols</code>. Preberimo samo ocene za matematiko:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb309-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;./test-script/data-raw/student-performance.xlsx&quot;</span></span>
<span id="cb309-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb309-2" aria-hidden="true" tabindex="-1"></a>ocene_math <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="fu">read.xlsx</span>(path, <span class="at">sheet =</span> <span class="st">&quot;Math scores&quot;</span>, <span class="at">startRow =</span> <span class="dv">1</span>,</span>
<span id="cb309-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb309-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">cols =</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">12</span>))</span>
<span id="cb309-4"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb309-4" aria-hidden="true" tabindex="-1"></a>ocene_math</span></code></pre></div>
<pre><code>## # A tibble: 395 x 4
##       G1    G2    G3 averageScore
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
##  1     5     6     6         5.67
##  2     5     5     6         5.33
##  3     7     8    10         8.33
##  4    15    14    15        14.7 
##  5     6    10    10         8.67
##  6    15    15    15        15   
##  7    12    12    11        11.7 
##  8     6     5     6         5.67
##  9    16    18    19        17.7 
## 10    14    15    15        14.7 
## # ... with 385 more rows</code></pre>
<p>Da podatke shranimo, uporabimo <code>write.xlsx()</code>.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb311-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;./test-script/data-raw/samo-ocene-math.xlsx&quot;</span></span>
<span id="cb311-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(ocene_math, path)</span></code></pre></div>
</div>
<div id="spss" class="section level4" number="3.5.2.2">
<h4><span class="header-section-number">3.5.2.2</span> SPSS</h4>
<p>SPSS je program za statistično analizo. Datoteke povezane z SPSS imajo običajno končnico <em>.sav</em>. Za branje iz in uvažanje v SPSS lahko uporabimo paket <strong>haven</strong>. V mapi <em>data_raw</em> imamo podatke o osebah <em>osebe.sav</em>. Za uvoz teh podatkov v R uporabimo funkcijo <code>read_sav</code>.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb312-2"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb312-2" aria-hidden="true" tabindex="-1"></a>podatki <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">&quot;./data-raw/osebe.sav&quot;</span>)</span>
<span id="cb312-3"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb312-3" aria-hidden="true" tabindex="-1"></a>podatki</span></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   Ime    Visina  Teza Spol  Starost
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;
## 1 Alen      171    70 m          41
## 2 Bojan     185    78 m          35
## 3 Cvetka    165    64 z          28
## 4 Dejan     190    95 m          52
## 5 Eva       152    67 z          22</code></pre>
<p>Da shranimo data frame v sav datoteko, uporabimo funkcijo <code>write_sav()</code>. Shranimo sedaj data frame <code>iris</code> v sav datoteko:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="nizi-kategori-ne-spremenljivke-in-datumi.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_sav</span>(iris, <span class="st">&quot;./data-clean/iris.sav&quot;</span>)</span></code></pre></div>
<p>Paket haven ima tudi funkcijo <code>read_por()</code> ki podpira starejše verzije datotek iz SPSS.</p>
</div>
</div>
</div>
<div id="ali-želite-izvedeti-več-2" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Ali želite izvedeti več?</h2>
<p>V tem poglavju smo si ogledali operacije treh paketov tidyversa. Če želite hiter in dokaj celovit pregled nad vsemi ukazi priporočamo, da si za vsak paket ogledate tako imenovan <strong>cheat sheet</strong>:</p>
<ul>
<li><strong>stringr</strong>: <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf" class="uri">https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf</a></li>
<li><strong>forcats</strong>: <a href="http://www.flutterbys.com.au/stats/downloads/slides/figure/factors.pdf" class="uri">http://www.flutterbys.com.au/stats/downloads/slides/figure/factors.pdf</a></li>
<li><strong>lubridate</strong>: <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_lubridate.pdf" class="uri">https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_lubridate.pdf</a></li>
</ul>
<p>Paket <strong>stringr</strong> uporablja paket <strong>stringi</strong>, ki ima na voljo več operacij, ki pa niso tako pogoste. Če se boste pri svojem delu srečali z zahtevnejšimi nalogami, lahko uporabite ta paket.</p>
<p>Za razumevanje regularnih izrazov in tudi avtomatsko razlago priporočamo stran <a href="https://regex101.com/" class="uri">https://regex101.com/</a>. Lahko si tudi ogledate knjigo Mastering Regular Expressions <span class="citation">(<a href="reference.html#ref-friedl2006mastering" role="doc-biblioref">Friedl 2006</a>)</span>, ki obsežno obravnava snov regularnih izrazov.</p>
</div>
<div id="domača-naloga-2" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Domača naloga</h2>
<ol style="list-style-type: decimal">
<li>Odprite datoteko DS-jobs.csv ter spremenite spremenljivko FormalEducation v tip faktor. Nato obdržite le štiri najbolj pogoste izobrazbe, ostale pa zamenjajte z vrednostjo “other.” Uporabite eno izmed funkcij v skupini <code>fct_lump</code>.</li>
</ol>
<pre><code>## # A tibble: 4,523 x 4
##    Gender Country          Age FormalEducation  
##    &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt; &lt;fct&gt;            
##  1 Female Australia         43 Bachelor&#39;s degree
##  2 Male   Russia            33 Bachelor&#39;s degree
##  3 Male   Taiwan            26 Master&#39;s degree  
##  4 Male   United States     25 Bachelor&#39;s degree
##  5 Male   United States     33 Doctoral degree  
##  6 Male   Czech Republic    21 Other            
##  7 Male   Russia            22 Bachelor&#39;s degree
##  8 Male   Netherlands       51 Master&#39;s degree  
##  9 Male   Colombia          34 Master&#39;s degree  
## 10 Male   Germany           41 Other            
## # ... with 4,513 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><p>Na podatkih <code>fruit</code> uporabite <code>str_subset</code> in poiščite:</p>
<ol style="list-style-type: lower-alpha">
<li>Vse sadeže, ki se začnejo in končajo na samoglasnik.</li>
</ol>
<pre><code>## [1] &quot;apple&quot;   &quot;avocado&quot; &quot;olive&quot;   &quot;orange&quot;</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Vse sadeže, ki imajo največ 5 črk.</li>
</ol>
<pre><code>##  [1] &quot;apple&quot; &quot;date&quot;  &quot;fig&quot;   &quot;grape&quot; &quot;guava&quot; &quot;lemon&quot; &quot;lime&quot;  &quot;mango&quot; &quot;nut&quot;  
## [10] &quot;olive&quot; &quot;peach&quot; &quot;pear&quot;  &quot;plum&quot;</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li><strong>težja</strong> Vse sadeže, pri katerih je prvi samoglasnik enak zadnjemu samoglasniku v besedi. Za rešitev je potrebno uporabiti negacijo in skupino.</li>
</ol>
<pre><code>##  [1] &quot;banana&quot;       &quot;bell pepper&quot;  &quot;blackcurrant&quot; &quot;clementine&quot;   &quot;elderberry&quot;  
##  [6] &quot;kiwi fruit&quot;   &quot;lychee&quot;       &quot;nectarine&quot;    &quot;papaya&quot;       &quot;pomelo&quot;      
## [11] &quot;rambutan&quot;     &quot;rock melon&quot;   &quot;satsuma&quot;</code></pre></li>
<li><p>Odprite prvi list ocen v <code>student-performance.xlsx</code> v mapi <code>test-script/data-raw/</code>.</p>
<ul>
<li>Odprite le stolpce school, absences, G1, G2, G3 in averageScore.</li>
<li>Dodajte stolpec <em>točke</em>, ki ima vrednosti med 0 in 100, tako da ima najvišja pripadajoča vrednost v averageScore vrednost 100.</li>
<li>Dodajte stolpec <em>ocena</em>, kjer so vrednosti za <em>točke</em> med 0 in 10 enake 1, 10 in 20 enake 2 itd.</li>
<li>Dodajte stolpec <em>besedna_ocena</em> tipa faktor, ki bo imel vrednosti glede na <em>oceno</em> in sicer ocene &lt;6 = “nezadostno,” 6 = “zadostno,” 7 = “v redu” 8 = “dobro,” 9 = “zelo dobro” in 10 = “odlično.”</li>
<li>Združite vrednosti “v redu” in “dobro” v eno vrednost “dobro.”</li>
</ul>
<pre><code>## # A tibble: 649 x 9
##    school absences    G1    G2    G3 averageScore točke ocena besedna_ocena
##    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;        
##  1 GP            4     0    11    11         7.33  39.3     4 nezadostno   
##  2 GP            2     9    11    11        10.3   55.4     6 zadostno     
##  3 GP            6    12    13    12        12.3   66.1     7 v redu       
##  4 GP            0    14    14    14        14     75       8 dobro        
##  5 GP            0    11    13    13        12.3   66.1     7 v redu       
##  6 GP            6    12    12    13        12.3   66.1     7 v redu       
##  7 GP            0    13    12    13        12.7   67.9     7 v redu       
##  8 GP            2    10    13    13        12     64.3     7 v redu       
##  9 GP            0    15    16    17        16     85.7     9 zelo dobro   
## 10 GP            0    12    12    13        12.3   66.1     7 v redu       
## # ... with 639 more rows</code></pre>
<ul>
<li>Shranite podatke v datoteko <code>students-performance-math-normalized.xlsx' in v binarno datoteko</code>students-performance-math-normalized.rds’.</li>
<li>Ponovno preberite obe datoteki, prvo v spremenljivko <code>podatki_excel</code> in drugo v <code>podatki_binarni</code>. Prvo tudi spremenit v tibble. Katero razliko opazite?</li>
</ul>
<pre><code>## # A tibble: 649 x 9
##    school absences    G1    G2    G3 averageScore točke ocena besedna_ocena
##    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        
##  1 GP            4     0    11    11         7.33  39.3     4 nezadostno   
##  2 GP            2     9    11    11        10.3   55.4     6 zadostno     
##  3 GP            6    12    13    12        12.3   66.1     7 v redu       
##  4 GP            0    14    14    14        14     75       8 dobro        
##  5 GP            0    11    13    13        12.3   66.1     7 v redu       
##  6 GP            6    12    12    13        12.3   66.1     7 v redu       
##  7 GP            0    13    12    13        12.7   67.9     7 v redu       
##  8 GP            2    10    13    13        12     64.3     7 v redu       
##  9 GP            0    15    16    17        16     85.7     9 zelo dobro   
## 10 GP            0    12    12    13        12.3   66.1     7 v redu       
## # ... with 639 more rows</code></pre>
<pre><code>## # A tibble: 649 x 9
##    school absences    G1    G2    G3 averageScore točke ocena besedna_ocena
##    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;        
##  1 GP            4     0    11    11         7.33  39.3     4 nezadostno   
##  2 GP            2     9    11    11        10.3   55.4     6 zadostno     
##  3 GP            6    12    13    12        12.3   66.1     7 v redu       
##  4 GP            0    14    14    14        14     75       8 dobro        
##  5 GP            0    11    13    13        12.3   66.1     7 v redu       
##  6 GP            6    12    12    13        12.3   66.1     7 v redu       
##  7 GP            0    13    12    13        12.7   67.9     7 v redu       
##  8 GP            2    10    13    13        12     64.3     7 v redu       
##  9 GP            0    15    16    17        16     85.7     9 zelo dobro   
## 10 GP            0    12    12    13        12.3   66.1     7 v redu       
## # ... with 639 more rows</code></pre></li>
<li><p>Naložite paket <code>nycflights13</code> s podatki letov. V tej bazi je več razpredelnic in sicer <strong>flights</strong>, <strong>airlines</strong>, <strong>planes</strong>, <strong>airports</strong> in <strong>weather</strong>. Za razumevanje si pomagajte z <code>?flights</code>.</p>
<ol style="list-style-type: lower-alpha">
<li>Izpišite vsa letališča, ki imajo 3 ali več besed v svojem imenu.</li>
</ol>
<pre><code>## # A tibble: 837 x 8
##    faa   name                        lat    lon   alt    tz dst   tzone         
##    &lt;chr&gt; &lt;chr&gt;                     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;         
##  1 06A   Moton Field Municipal Ai~  32.5  -85.7   264    -6 A     America/Chica~
##  2 09J   Jekyll Island Airport      31.1  -81.4    11    -5 A     America/New_Y~
##  3 0A9   Elizabethton Municipal A~  36.4  -82.2  1593    -5 A     America/New_Y~
##  4 0G6   Williams County Airport    41.5  -84.5   730    -5 A     America/New_Y~
##  5 0G7   Finger Lakes Regional Ai~  42.9  -76.8   492    -5 A     America/New_Y~
##  6 0P2   Shoestring Aviation Airf~  39.8  -76.6  1000    -5 U     America/New_Y~
##  7 0S9   Jefferson County Intl      48.1 -123.    108    -8 A     America/Los_A~
##  8 0W3   Harford County Airport     39.6  -76.2   409    -5 A     America/New_Y~
##  9 10C   Galt Field Airport         42.4  -88.4   875    -6 U     America/Chica~
## 10 17G   Port Bucyrus-Crawford Co~  40.8  -83.0  1003    -5 A     America/New_Y~
## # ... with 827 more rows</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li><strong>Težja</strong> Spremenite imena letališč tako, da odstranite besedi “Airport” ali “Airfield” iz konca imena.</li>
</ol>
<pre><code>## # A tibble: 1,458 x 8
##    faa   name                      lat    lon   alt    tz dst   tzone           
##    &lt;chr&gt; &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;           
##  1 04G   &quot;Lansdowne &quot;             41.1  -80.6  1044    -5 A     America/New_York
##  2 06A   &quot;Moton Field Municipal~  32.5  -85.7   264    -6 A     America/Chicago 
##  3 06C   &quot;Schaumburg Regional&quot;    42.0  -88.1   801    -6 A     America/Chicago 
##  4 06N   &quot;Randall &quot;               41.4  -74.4   523    -5 A     America/New_York
##  5 09J   &quot;Jekyll Island &quot;         31.1  -81.4    11    -5 A     America/New_York
##  6 0A9   &quot;Elizabethton Municipa~  36.4  -82.2  1593    -5 A     America/New_York
##  7 0G6   &quot;Williams County &quot;       41.5  -84.5   730    -5 A     America/New_York
##  8 0G7   &quot;Finger Lakes Regional~  42.9  -76.8   492    -5 A     America/New_York
##  9 0P2   &quot;Shoestring Aviation &quot;   39.8  -76.6  1000    -5 U     America/New_York
## 10 0S9   &quot;Jefferson County Intl&quot;  48.1 -123.    108    -8 A     America/Los_Ang~
## # ... with 1,448 more rows</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Za vsak let sestavite besedno poročilo spodnje oblike, ki ga shranite v stolpec <em>Poročilo leta</em>.</p>
<p>Besedilo naj se glasi: “Let iz letalisca Newark Liberty Intl dne 22.01.13 ob 11:00 v letalisce George Bush Intercontinental je imel 2 minut zamude v odhodu in 11 v prihodu.”</p>
<p>Minute so lahko tudi negativne.</p></li>
</ol>
<pre><code>## # A tibble: 336,776 x 2
##    `Poročilo leta`                                           dep_string         
##    &lt;chr&gt;                                                     &lt;dttm&gt;             
##  1 Let iz letalisca Newark Liberty Intl, dne 01.01.13, ob 0~ 2013-01-01 05:15:00
##  2 Let iz letalisca La Guardia, dne 01.01.13, ob 05:29 v le~ 2013-01-01 05:29:00
##  3 Let iz letalisca John F Kennedy Intl, dne 01.01.13, ob 0~ 2013-01-01 05:40:00
##  4 &lt;NA&gt;                                                      2013-01-01 05:45:00
##  5 Let iz letalisca La Guardia, dne 01.01.13, ob 06:00 v le~ 2013-01-01 06:00:00
##  6 Let iz letalisca Newark Liberty Intl, dne 01.01.13, ob 0~ 2013-01-01 05:58:00
##  7 Let iz letalisca Newark Liberty Intl, dne 01.01.13, ob 0~ 2013-01-01 06:00:00
##  8 Let iz letalisca La Guardia, dne 01.01.13, ob 06:00 v le~ 2013-01-01 06:00:00
##  9 Let iz letalisca John F Kennedy Intl, dne 01.01.13, ob 0~ 2013-01-01 06:00:00
## 10 Let iz letalisca La Guardia, dne 01.01.13, ob 06:00 v le~ 2013-01-01 06:00:00
## # ... with 336,766 more rows</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>Časi odhodov in prihodov so v razpredelnici flights v lokalnem času. Dodajte spremenljivko <code>dep_time_utc</code>, ki bo vsebovala vrednost odhoda v časovnem pasu UTC. Zapis naj bo oblike integer, tako kot `dep_time’.</li>
</ol>
<pre><code>## # A tibble: 336,776 x 8
##     year month   day dep_time dep_time_utc origin dest  tzone           
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;           
##  1  2013     1     1      517 1017         EWR    IAH   America/New_York
##  2  2013     1     1      533 1033         LGA    IAH   America/New_York
##  3  2013     1     1      542 1042         JFK    MIA   America/New_York
##  4  2013     1     1      544 1044         JFK    BQN   America/New_York
##  5  2013     1     1      554 1054         LGA    ATL   America/New_York
##  6  2013     1     1      554 1054         EWR    ORD   America/New_York
##  7  2013     1     1      555 1055         EWR    FLL   America/New_York
##  8  2013     1     1      557 1057         LGA    IAD   America/New_York
##  9  2013     1     1      557 1057         JFK    MCO   America/New_York
## 10  2013     1     1      558 1058         LGA    ORD   America/New_York
## # ... with 336,766 more rows</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li>Simuliramo. Vsi leti bodo zaradi nepričakovane prenove letališča po 23. 10. 2013 zamaknjeni za dva tedna. Izpišite posodobljene datume v originalni obliki (year, month, day).</li>
</ol>
<pre><code>## # A tibble: 63,797 x 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013    11     6      454            500        -6      632            648
##  2  2013    11     6      512            517        -5      749            757
##  3  2013    11     6      541            545        -4      837            827
##  4  2013    11     6      544            545        -1      935            933
##  5  2013    11     6      545            550        -5      930            932
##  6  2013    11     6      546            545         1      856            855
##  7  2013    11     6      549            600       -11      711            716
##  8  2013    11     6      549            600       -11      900            858
##  9  2013    11     6      550            600       -10      716            717
## 10  2013    11     6      552            600        -8      735            751
## # ... with 63,787 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
## #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="urejeni-in-relacijski-podatki.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-strings-factors-dates.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
